tooltip = body_adj, data_id = body_adj))+
labs(x = "Body type", y = "Median Price", title = "All brands median price in each body type", fill = "Body Type") +
scale_fill_brewer(palette = "Paired")+
theme(axis.text.x = element_text(angle = 90, vjust =0.5))+
scale_y_continuous(labels = comma)
df_mazda[, .(med_price = median(price_adj)), .(model,body_adj)]
gg_mazda_body_model_medP <- df_mazda[, .(med_price = median(price_adj)), .(model,body_adj)] %>%
ggplot()+
geom_col_interactive(aes(x = model, y = med_price, fill = body_adj,
tooltip = med_price, data_id = med_price))+
labs(x = "Model", y ="stacked median price", title = "Mazda stacked median price for body type and model", fill = "Body Type")+
scale_fill_brewer(palette = "Paired")+
theme(axis.text.x = element_text(angle = 90, vjust =0.5))+
scale_y_continuous(labels = comma) # change y axis number format
girafe(ggobj = gg_mazda_body_model_medP)
girafe(ggobj = gg_newcar_boxplot)
girafe(ggobj = gg_all_boxplot)
df_test[,.(med_price = median(price_adj)), .(body_adj)]
med_price_all <- df_test[,.(med_price = median(price_adj)), .(body_adj)]
med_price_new <- df_test[year %in% c(2020,2021),.(med_price = median(price_adj))
, .(body_adj)]
med_price_new <- df_test[year %in% c(2020,2021),.(med_price_new = median(price_adj))
, .(body_adj)]
med_price_body <- merge(med_price_all,med_price_new)
View(med_price_body)
med_price_body[, .(change = (med_price - med_price_new)/(med_price)), body_adj]
med_price_body[, .(change = (med_price_new - med_price)/(med_price)), body_adj]
med_price_body[, .(change = (med_price_new / med_price)), body_adj]
med_price_body[, .(change = (med_price_new / med_price)-1), body_adj]
med_price_body[, .(change = (med_price_new / med_price)-1)%, body_adj]
?percent
?percent_format
med_price_body[, .(change = label_percent((med_price_new / med_price)-1)), body_adj]
med_price_body[, .(change = percent((med_price_new / med_price)-1)), body_adj]
med_price_body[, .(change = percent((med_price_new / med_price)-1)), body_adj] %>%
ggplot(.)+
geom_boxplot_interactive(aes(x = body_adj, y = price_adj, fill = body_adj,
tooltip = body_adj, data_id = body_adj))+
labs(x = "Body type", y = "Median Price percentage changes", title = "All brands percentage changes from all MY to new MY (20 and 21)", fill = "Body Type") +
scale_fill_brewer(palette = "Paired")+
theme(axis.text.x = element_text(angle = 90, vjust =0.5))+
scale_y_continuous(labels = comma)
med_price_body[, .(change = percent((med_price_new / med_price)-1)), body_adj] %>%
ggplot(.)+
geom_boxplot_interactive(aes(x = body_adj, y = change, fill = body_adj,
tooltip = body_adj, data_id = body_adj))+
labs(x = "Body type", y = "Median Price percentage changes", title = "All brands percentage changes from all MY to new MY (20 and 21)", fill = "Body Type") +
scale_fill_brewer(palette = "Paired")+
theme(axis.text.x = element_text(angle = 90, vjust =0.5))+
scale_y_continuous(labels = comma)
med_price_body[, .(change = percent((med_price_new / med_price)-1)), body_adj] %>%
ggplot(.)+
geom_col_interactive(aes(x = body_adj, y = change, fill = body_adj,
tooltip = body_adj, data_id = body_adj))+
labs(x = "Body type", y = "Median Price percentage changes", title = "All brands percentage changes from all MY to new MY (20 and 21)", fill = "Body Type") +
scale_fill_brewer(palette = "Paired")+
theme(axis.text.x = element_text(angle = 90, vjust =0.5))+
scale_y_continuous(labels = comma)
med_price_body[, .(change = percent((med_price_new / med_price)-1)), body_adj] %>%
ggplot(.)+
geom_bar_interactive(aes(x = body_adj, y = change, fill = body_adj,
tooltip = body_adj, data_id = body_adj))+
labs(x = "Body type", y = "Median Price percentage changes", title = "All brands percentage changes from all MY to new MY (20 and 21)", fill = "Body Type") +
scale_fill_brewer(palette = "Paired")+
theme(axis.text.x = element_text(angle = 90, vjust =0.5))+
scale_y_continuous(labels = comma)
med_price_body[, .(change = percent((med_price_new / med_price)-1)), body_adj] %>%
ggplot(.)+
geom_line_interactive(aes(x = body_adj, y = change, fill = body_adj,
tooltip = body_adj, data_id = body_adj))+
labs(x = "Body type", y = "Median Price percentage changes", title = "All brands percentage changes from all MY to new MY (20 and 21)", fill = "Body Type") +
scale_fill_brewer(palette = "Paired")+
theme(axis.text.x = element_text(angle = 90, vjust =0.5))+
scale_y_continuous(labels = comma)
med_price_body[, .(change = percent((med_price_new / med_price)-1)), body_adj]
med_price_body[, .(change = percent((med_price_new / med_price)-1)), body_adj] %>%
ggplot()+
geom_col(x = body_adj, weigh = change)
med_price_body[, .(change = ((med_price_new / med_price)-1)), body_adj]
med_price_body[, .(change = ((med_price_new / med_price)-1)), body_adj] %>%
ggplot()+
geom_col(x = body_adj, weigh = change)
df_change <- med_price_body[, .(change = ((med_price_new / med_price)-1)), body_adj]
df_change
ggplot(df_change)+
geom_col(x = body_adj, weigh = change)
ggplot(df_change)+
geom_col(aes(x = body_adj, y = change))
df_change <- med_price_body[, .(change = percent((med_price_new / med_price)-1)), body_adj]
ggplot(df_change)+
geom_col(aes(x = body_adj, y = change))
ggplot(df_change)+
geom_col(aes(x = body_adj, y = change))
ggplot(df_change)+
geom_col(aes(x = body_adj, y = change))
df_change <- med_price_body[, .(change = ((med_price_new / med_price)-1)), body_adj]
ggplot(df_change)+
geom_col(aes(x = body_adj, y = change))
df_change <- med_price_body[, .(change = percent((med_price_new / med_price)-1)), body_adj]
ggplot(df_change[order(change)])+
geom_col(aes(x = body_adj, y = change))
df_change[order(change)]
ggplot(df_change[order(change)])+
geom_col(aes(x = body_adj, y = order(change)))
ggplot(df_change)+
geom_col(aes(x = body_adj, y = order(change)))
df_change <- med_price_body[, .(change = ((med_price_new / med_price)-1)), body_adj]
ggplot(df_change)+
geom_col(aes(x = body_adj, y = order(change)))
ggplot(df_change)+
geom_col_interactive(aes(x = body_adj, y = order(change)))
ggplot(df_change)+
geom_col_interactive(aes(x = body_adj, y = order(change), tooltip = change, data_id = change))
ggplot(df_change)+
geom_col_interactive(aes(x = body_adj, y = order(change), tooltip = change, data_id = change, fill = body_adj))
ggplot(df_change)+
geom_col_interactive(aes(x = body_adj, y = order(change), tooltip = change, data_id = change, fill = body_adj))+
labs(x = "Body type", y = "Median Price", title = "All brands median price in each body type", fill = "Body Type") +
scale_fill_brewer(palette = "Paired")+
theme(axis.text.x = element_text(angle = 90, vjust =0.5))+
scale_y_continuous(labels = comma)
ggplot(df_change)+
geom_col_interactive(aes(x = body_adj, y = order(change), tooltip = change, data_id = change, fill = body_adj))+
labs(x = "Body type", y = "Median Price", title = "All brands median price in each body type", fill = "Body Type") +
scale_fill_brewer(palette = "Paired")+
theme(axis.text.x = element_text(angle = 90, vjust =0.5))+
scale_y_continuous(labels = percent)
ggplot(df_change)+
geom_col_interactive(aes(x = body_adj, y = order(change), tooltip = change, data_id = change, fill = body_adj))+
labs(x = "Body type", y = "Median Price", title = "All brands median price in each body type", fill = "Body Type") +
scale_fill_brewer(palette = "Paired")+
theme(axis.text.x = element_text(angle = 90, vjust =0.5))+
scale_y_continuous(labels = commar)
ggplot(df_change)+
geom_col_interactive(aes(x = body_adj, y = order(change), tooltip = change, data_id = change, fill = body_adj))+
labs(x = "Body type", y = "Median Price", title = "All brands median price in each body type", fill = "Body Type") +
scale_fill_brewer(palette = "Paired")+
theme(axis.text.x = element_text(angle = 90, vjust =0.5))+
scale_y_continuous(labels = comma)
df_change
df_change <- med_price_body[, .(change = (med_price_new / med_price)-1), body_adj]
ggplot(df_change)+
geom_col_interactive(aes(x = body_adj, y = order(change), tooltip = change, data_id = change, fill = body_adj))+
labs(x = "Body type", y = "Median Price", title = "All brands median price in each body type", fill = "Body Type") +
scale_fill_brewer(palette = "Paired")+
theme(axis.text.x = element_text(angle = 90, vjust =0.5))+
scale_y_continuous(labels = comma)
ggplot(df_change)+
geom_col_interactive(aes(x = body_adj, y = change, tooltip = change, data_id = change, fill = body_adj))+
labs(x = "Body type", y = "Median Price", title = "All brands median price in each body type", fill = "Body Type") +
scale_fill_brewer(palette = "Paired")+
theme(axis.text.x = element_text(angle = 90, vjust =0.5))+
scale_y_continuous(labels = comma)
ggplot(df_change)+
geom_col_interactive(aes(x = body_adj, y = change, tooltip = change, data_id = change, fill = body_adj))+
labs(x = "Body type", y = "Median Price", title = "All brands median price in each body type", fill = "Body Type") +
scale_fill_brewer(palette = "Paired")+
theme(axis.text.x = element_text(angle = 90, vjust =0.5))+
scale_y_continuous(labels = percent)
ggplot(df_change)+
geom_col_interactive(aes(x = body_adj, y = change, tooltip = change, data_id = change, fill = body_adj))+
labs(x = "Body type", y = "Median Price", title = "Percentage change from all MY to MY20 and MY21", fill = "Body Type") +
scale_fill_brewer(palette = "Paired")+
theme(axis.text.x = element_text(angle = 90, vjust =0.5))+
scale_y_continuous(labels = percent)
ggplot(df_change)+
geom_col_interactive(aes(x = body_adj, y = change, tooltip = change, data_id = change, fill = body_adj))+
labs(x = "Body type", y = "Median Price", title = "Percentage changes from all MY to MY20 and MY21", fill = "Body Type") +
scale_fill_brewer(palette = "Paired")+
theme(axis.text.x = element_text(angle = 90, vjust =0.5))+
scale_y_continuous(labels = percent)
ggplot(df_change)+
geom_col_interactive(aes(x = body_adj, y = change, tooltip = change, data_id = change, fill = body_adj))+
labs(x = "Body type", y = "Median Price", title = "Percentage changes from all MY to MY20&21", fill = "Body Type") +
scale_fill_brewer(palette = "Paired")+
theme(axis.text.x = element_text(angle = 90, vjust =0.5))+
scale_y_continuous(labels = percent)
gg_changes <- ggplot(df_change)+
geom_col_interactive(aes(x = body_adj, y = change, tooltip = change, data_id = change, fill = body_adj))+
labs(x = "Body type", y = "Median Price", title = "Percentage changes from all MY to MY20&21", fill = "Body Type") +
scale_fill_brewer(palette = "Paired")+
theme(axis.text.x = element_text(angle = 90, vjust =0.5))+
scale_y_continuous(labels = percent)
girafe(ggobj = gg_changes)
gg_changes <- ggplot(df_change)+
geom_col_interactive(aes(x = body_adj, y = round(change), tooltip = change, data_id = change, fill = body_adj))+
labs(x = "Body type", y = "Median Price", title = "Percentage changes from all MY to MY20&21", fill = "Body Type") +
scale_fill_brewer(palette = "Paired")+
theme(axis.text.x = element_text(angle = 90, vjust =0.5))+
scale_y_continuous(labels = percent)
girafe(ggobj = gg_changes)
gg_changes <- ggplot(df_change)+
geom_col_interactive(aes(x = body_adj, y = round(change,5), tooltip = change, data_id = change, fill = body_adj))+
labs(x = "Body type", y = "Median Price", title = "Percentage changes from all MY to MY20&21", fill = "Body Type") +
scale_fill_brewer(palette = "Paired")+
theme(axis.text.x = element_text(angle = 90, vjust =0.5))+
scale_y_continuous(labels = percent)
girafe(ggobj = gg_changes)
gg_changes <- ggplot(df_change)+
geom_col_interactive(aes(x = body_adj, y = change, tooltip = change, data_id = change, fill = body_adj))+
labs(x = "Body type", y = "Median Price", title = "Percentage changes from all MY to MY20&21", fill = "Body Type") +
scale_fill_brewer(palette = "Paired")+
theme(axis.text.x = element_text(angle = 90, vjust =0.5))+
scale_y_continuous(labels = percent)
girafe(ggobj = gg_changes)
med_price_all <- df_test[,.(med_price = median(price_adj)), .(body_adj)]
med_price_new <- df_test[year %in% c(2020,2021),.(med_price_new = median(price_adj))
, .(body_adj)]
med_price_body <- merge(med_price_all,med_price_new)
df_change <- med_price_body[, .(change = (med_price_new / med_price)-1), body_adj]
gg_changes <- ggplot(df_change)+
geom_col_interactive(aes(x = body_adj, y = change, tooltip = change, data_id = change, fill = body_adj))+
labs(x = "Body type", y = "Median Price", title = "Percentage changes of med price  from all MY to MY20&21", fill = "Body Type") +
scale_fill_brewer(palette = "Paired")+
theme(axis.text.x = element_text(angle = 90, vjust =0.5))+
scale_y_continuous(labels = percent)
girafe(ggobj = gg_changes)
df_test[!year %in% c(2020,2021),.(med_price = median(price_adj)), .(body_adj)]
med_price_all <- df_test[!year %in% c(2020,2021),.(med_price = median(price_adj)), .(body_adj)]
med_price_new <- df_test[year %in% c(2020,2021),.(med_price_new = median(price_adj))
, .(body_adj)]
med_price_body <- merge(med_price_all,med_price_new)
df_change <- med_price_body[, .(change = (med_price_new / med_price)-1), body_adj]
gg_changes <- ggplot(df_change)+
geom_col_interactive(aes(x = body_adj, y = change, tooltip = change, data_id = change, fill = body_adj))+
labs(x = "Body type", y = "Median Price", title = "Percentage changes of med price  from all MY to MY20&21", fill = "Body Type") +
scale_fill_brewer(palette = "Paired")+
theme(axis.text.x = element_text(angle = 90, vjust =0.5))+
scale_y_continuous(labels = percent)
girafe(ggobj = gg_changes)
med_price_all <- df_test[!year %in% c(2020,2021),.(med_price = median(price_adj)), .(body_adj)]
med_price_new <- df_test[year %in% c(2020,2021),.(med_price_new = median(price_adj))
, .(body_adj)]
med_price_body <- merge(med_price_all,med_price_new)
df_change <- med_price_body[, .(change = (med_price_new / med_price)-1), body_adj]
gg_changes <- ggplot(df_change)+
geom_col_interactive(aes(x = body_adj, y = change, tooltip = change, data_id = change, fill = body_adj))+
labs(x = "Body type", y = "Median Price", title = "Percentage changes of med price  between MY11~19 and MY20&21", fill = "Body Type") +
scale_fill_brewer(palette = "Paired")+
theme(axis.text.x = element_text(angle = 90, vjust =0.5))+
scale_y_continuous(labels = percent)
girafe(ggobj = gg_changes)
gg_changes <- ggplot(df_change)+
geom_col_interactive(aes(x = body_adj, y = change, tooltip = change, data_id = change, fill = body_adj))+
labs(x = "Body type", y = "Median Price", title = "% changes of med price  between MY11~19 and MY20&21", fill = "Body Type") +
scale_fill_brewer(palette = "Paired")+
theme(axis.text.x = element_text(angle = 90, vjust =0.5))+
scale_y_continuous(labels = percent)
girafe(ggobj = gg_changes)
gg_changes <- ggplot(df_change)+
geom_col_interactive(aes(x = body_adj, y = change, tooltip = change, data_id = change, fill = body_adj))+
labs(x = "Body type", y = "Median Price", title = "% changes of med price  between MY20&21 and older MY", fill = "Body Type") +
scale_fill_brewer(palette = "Paired")+
theme(axis.text.x = element_text(angle = 90, vjust =0.5))+
scale_y_continuous(labels = percent)
girafe(ggobj = gg_changes)
gg_changes <- ggplot(df_change)+
geom_col_interactive(aes(x = body_adj, y = change, tooltip = change, data_id = change, fill = body_adj))+
labs(x = "Body type", y = "Median Price % change", title = "% changes of med price  between MY20&21 and older MY", fill = "Body Type") +
scale_fill_brewer(palette = "Paired")+
theme(axis.text.x = element_text(angle = 90, vjust =0.5))+
scale_y_continuous(labels = percent)
girafe(ggobj = gg_changes)
girafe(ggobj = gg_mazda_body_medP)
girafe(ggobj = gg_volkswagen_body_model_medP)
girafe(ggobj = gg_volkswagen_body_medP)
df_volkswagen %>%
ggplot()+
geom_boxplot_interactive(aes(
x = body_adj, y = price_adj, fill = body_adj, tooltip = body_adj, data_id = body_adj
))
girafe(ggobj = gg_volkswagen_body_model_medP)
df_volkswagen %>%
ggplot()+
geom_boxplot_interactive(aes(
x = body_adj, y = price_adj, fill = body_adj, tooltip = body_adj, data_id = body_adj
)) +
labs(x = "Body type", y = "Median Price", title = "Volkswagen median price of each body type", fill = "Body Type") +
scale_fill_brewer(palette = "Paired")+# try palette
theme(axis.text.x = element_text(angle = 90, vjust =0.5))+
scale_y_continuous(labels = comma) # change y axis number format
gg_box_volkswagen_medp_body <- df_volkswagen %>%
ggplot()+
geom_boxplot_interactive(aes(
x = body_adj, y = price_adj, fill = body_adj, tooltip = body_adj, data_id = body_adj
)) +
labs(x = "Body type", y = "Median Price", title = "Volkswagen median price of each body type", fill = "Body Type") +
scale_fill_brewer(palette = "Paired")+# try palette
theme(axis.text.x = element_text(angle = 90, vjust =0.5))+
scale_y_continuous(labels = comma) # change y axis number format
girafe(ggobj = gg_box_volkswagen_medp_body)
df_volkswagen[body_adj %in% c("Convertible", "Coupe "), .N, year]
girafe(ggobj = gg_volkswagen_body_model_medP)
gg_box_Toyota_medp_body <- df_toyota %>%
ggplot()+
geom_boxplot_interactive(aes(
x = body_adj, y = price_adj, fill = body_adj, tooltip = body_adj, data_id = body_adj
)) +
labs(x = "Body type", y = "Median Price", title = "Toyota median price of each body type", fill = "Body Type") +
scale_fill_brewer(palette = "Paired")+# try palette
theme(axis.text.x = element_text(angle = 90, vjust =0.5))+
scale_y_continuous(labels = comma) # change y axis number format
girafe(ggobj = gg_box_Toyota_medp_body)
girafe(ggobj = gg_toyota_body_medP)
girafe(ggobj = gg_box_Toyota_medp_body)
df_toyota[, .(medprice = median(price_adj)), year]
df_test[!make == "Toyota"]
df_test[!make == "Toyota", .(medprice = median(price_adj)), year]
df_toyota[, .(medprice = median(price_adj)), year]
df_test[!make == "Toyota", .(medprice = median(price_adj)), year]
df_toyota[, .(meanprice = mean(price_adj)), year]
df_test[!make == "Toyota", .(meanprice = mean(price_adj)), year]
df_toyota[, .(meanprice_toyota = mean(price_adj)), year]
df_test[!make == "Toyota", .(meanprice_exclud_toyota = mean(price_adj)), year]
df_meanp_exc_toyota <- df_test[!make == "Toyota", .(meanprice_exclud_toyota = mean(price_adj)), year]
df_meanp_toyota <- df_toyota[, .(meanprice_toyota = mean(price_adj)), year]
df_meanp <- merge(df_meanp_toyota, df_meanp_exc_toyota)
df_meanp
df_meanp %>%
ggplot()+
geom_line(aes(
x = year, y = meanprice_toyota
))
df_meanp %>%
ggplot()+
geom_line(aes(
x = year, y = meanprice_toyota
))+
scale_x_continuous(breaks = seq(2011,2021,1))
df_meanp %>%
ggplot()+
geom_line(aes(
x = year, y = meanprice_toyota, color = "red"
))+
scale_x_continuous(breaks = seq(2011,2021,1))
df_meanp %>%
ggplot()+
geom_line(aes(
x = year, y = meanprice_toyota, color = "Toyota"
))+
scale_x_continuous(breaks = seq(2011,2021,1))
df_meanp
df_meanp %>%
ggplot()+
geom_line(aes(
x = year, y = meanprice_toyota, color = "Toyota"
))+
geom_line(aes(y = meanprice_exclud_toyota, color = "Others"))+
scale_x_continuous(breaks = seq(2011,2021,1))
df_meanp %>%
ggplot()+
geom_line(aes(
x = year, y = meanprice_toyota, color = "Toyota"
))+
geom_line(aes(x = year, y = meanprice_exclud_toyota, color = "Others"))+
scale_x_continuous(breaks = seq(2011,2021,1))
df_meanp %>%
ggplot()+
geom_line(aes(
x = year, y = meanprice_toyota, color = "Toyota"
))+
geom_point_interactive(aes(
x = year, y = meanprice_toyota, color = "Toyota"
))+
geom_line(aes(x = year, y = meanprice_exclud_toyota, color = "Others"))+
scale_x_continuous(breaks = seq(2011,2021,1))
df_meanp %>%
ggplot()+
geom_line(aes(
x = year, y = meanprice_toyota, color = "Toyota"
))+
geom_point_interactive(aes(
x = year, y = meanprice_toyota, color = "Toyota", tooltip = meanprice_toyota, data_id = meanprice_toyota
))+
geom_line(aes(x = year, y = meanprice_exclud_toyota, color = "Others"))+
scale_x_continuous(breaks = seq(2011,2021,1))
df_meanp %>%
ggplot()+
geom_line(aes(
x = year, y = meanprice_toyota, color = "Toyota"
))+
geom_point_interactive(aes(
x = year, y = meanprice_toyota, color = "Toyota", tooltip = meanprice_toyota, data_id = meanprice_toyota
))+
geom_line(aes(x = year, y = meanprice_exclud_toyota, color = "Others"))+
geom_point_interactive(aes(
x = year, y = meanprice_exclud_toyota, color = "Others", tooltip = meanprice_exclud_toyota, data_id = meanprice_exclud_toyota
))+
scale_x_continuous(breaks = seq(2011,2021,1))
df_meanp %>%
ggplot()+
geom_line(aes(
x = year, y = meanprice_toyota, color = "Toyota"
))+
geom_point_interactive(aes(
x = year, y = meanprice_toyota, color = "Toyota", tooltip = meanprice_toyota, data_id = meanprice_toyota
))+
geom_line(aes(x = year, y = meanprice_exclud_toyota, color = "Others"))+
geom_point_interactive(aes(
x = year, y = meanprice_exclud_toyota, color = "Others", tooltip = meanprice_exclud_toyota, data_id = meanprice_exclud_toyota
))+
scale_x_continuous(breaks = seq(2011,2021,1))+
labs(x = "Model Years", y = "Mean Prices", title = "Mean Prices of Toyota and others")
df_meanp %>%
ggplot()+
geom_line(aes(
x = year, y = meanprice_toyota, color = "Toyota"
))+
geom_point_interactive(aes(
x = year, y = meanprice_toyota, color = "Toyota", tooltip = meanprice_toyota, data_id = meanprice_toyota
))+
geom_line(aes(x = year, y = meanprice_exclud_toyota, color = "Others"))+
geom_point_interactive(aes(
x = year, y = meanprice_exclud_toyota, color = "Others", tooltip = meanprice_exclud_toyota, data_id = meanprice_exclud_toyota
))+
scale_x_continuous(breaks = seq(2011,2021,1))+
labs(x = "Model Years", y = "Mean Prices", title = "Mean Prices of Toyota and other Brands")
gg_meanprice_compare <- df_meanp %>%
ggplot()+
geom_line(aes(
x = year, y = meanprice_toyota, color = "Toyota"
))+
geom_point_interactive(aes(
x = year, y = meanprice_toyota, color = "Toyota", tooltip = meanprice_toyota, data_id = meanprice_toyota
))+
geom_line(aes(x = year, y = meanprice_exclud_toyota, color = "Others"))+
geom_point_interactive(aes(
x = year, y = meanprice_exclud_toyota, color = "Others", tooltip = meanprice_exclud_toyota, data_id = meanprice_exclud_toyota
))+
scale_x_continuous(breaks = seq(2011,2021,1))+
labs(x = "Model Years", y = "Mean Prices", title = "Mean Prices of Toyota and other Brands")
girafe(ggobj = gg_meanprice_compare)
gg_meanprice_compare <- df_meanp %>%
ggplot()+
geom_line(aes(
x = year, y = meanprice_toyota, color = "Toyota"
))+
geom_point_interactive(aes(
x = year, y = meanprice_toyota, color = "Toyota", tooltip = meanprice_toyota, data_id = meanprice_toyota
))+
geom_line(aes(x = year, y = meanprice_exclud_toyota, color = "Others"))+
geom_point_interactive(aes(
x = year, y = meanprice_exclud_toyota, color = "Others", tooltip = meanprice_exclud_toyota, data_id = meanprice_exclud_toyota
))+
scale_x_continuous(breaks = seq(2011,2021,1))+
labs(x = "Model Years", y = "Mean Prices", title = "Mean Prices of Toyota and other Brands in Australia")
girafe(ggobj = gg_meanprice_compare)
gg_meanprice_compare <- df_meanp %>%
ggplot()+
geom_line(aes(
x = year, y = meanprice_toyota, color = "Toyota"
))+
geom_point_interactive(aes(
x = year, y = meanprice_toyota, color = "Toyota", tooltip = meanprice_toyota, data_id = meanprice_toyota
))+
geom_line(aes(x = year, y = meanprice_exclud_toyota, color = "Others"))+
geom_point_interactive(aes(
x = year, y = meanprice_exclud_toyota, color = "Others", tooltip = meanprice_exclud_toyota, data_id = meanprice_exclud_toyota
))+
scale_x_continuous(breaks = seq(2011,2021,1))+
labs(x = "Model Years", y = "Mean Prices", title = "Mean Prices of Toyota and other Brands in Australia", fill = "Brand")
girafe(ggobj = gg_meanprice_compare)
gg_meanprice_compare <- df_meanp %>%
ggplot()+
geom_line(aes(
x = year, y = meanprice_toyota, color = "Toyota"
))+
geom_point_interactive(aes(
x = year, y = meanprice_toyota, color = "Toyota", tooltip = meanprice_toyota, data_id = meanprice_toyota
))+
geom_line(aes(x = year, y = meanprice_exclud_toyota, color = "Others"))+
geom_point_interactive(aes(
x = year, y = meanprice_exclud_toyota, color = "Others", tooltip = meanprice_exclud_toyota, data_id = meanprice_exclud_toyota
))+
scale_x_continuous(breaks = seq(2011,2021,1))+
labs(x = "Model Years", y = "Mean Prices", title = "Mean Prices of Toyota and other Brands in Australia", fill = "Brand")
girafe(ggobj = gg_meanprice_compare)
gg_meanprice_compare <- df_meanp %>%
ggplot()+
geom_line(aes(
x = year, y = meanprice_toyota, color = "Toyota"
))+
geom_point_interactive(aes(
x = year, y = meanprice_toyota, color = "Toyota", tooltip = meanprice_toyota, data_id = meanprice_toyota
))+
geom_line(aes(x = year, y = meanprice_exclud_toyota, color = "Others"))+
geom_point_interactive(aes(
x = year, y = meanprice_exclud_toyota, color = "Others", tooltip = meanprice_exclud_toyota, data_id = meanprice_exclud_toyota
))+
scale_x_continuous(breaks = seq(2011,2021,1))+
labs(x = "Model Years", y = "Mean Prices", title = "Mean Prices of Toyota and other Brands in Australia", color = "Brand")
girafe(ggobj = gg_meanprice_compare)
girafe(ggobj = gg_toyota_body_model_medP)
girafe(ggobj = gg_meanprice_compare)
df_test[!seller_ad = "incorrect seller"]
df_test[!seller_ad == "incorrect seller"]
df_test[!seller_ad == "incorrect seller", .(meanprice = mean(price_adj)), .(seller_ad)]
df_test[!seller_ad == "incorrect seller"] %>%
ggplot()+
geom_boxplot_interactive(aes(
x = seller_ad, y = price_adj, fill = seller_ad, tooltip = seller_ad, data_id = seller_ad
))
gg_seller <- df_test[!seller_ad == "incorrect seller"] %>%
ggplot()+
geom_boxplot_interactive(aes(
x = seller_ad, y = price_adj, fill = seller_ad, tooltip = seller_ad, data_id = seller_ad
))+
labs(x = "Seller", y = "Price", title = "Price made between dealer and private", fill = "Seller") +
scale_fill_brewer(palette = "Paired")+
theme(axis.text.x = element_text(angle = 90, vjust =0.5))+
scale_y_continuous(labels = comma, breaks = seq(0,470000,50000))
girafe(ggobj = gg_seller)
