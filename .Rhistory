View(df_bmw)
df_bmw[,.N,model]
# Holden
df_bmw <- df_test[make=="Holden"]
# BMW
df_bmw <- df_test[make=="BMW"]
df_bmw[, model:= ifelse(str_detect(model_badge,"Series") == TRUE,
word(model_badge,1,2), word(model_badge,1))]
df_bmw[,.N,model]
# Holden
df_holden <- df_test[make=="Holden"]
View(df_holden)
df_holden[,.N,model_badge]
df_holden[model:= word(model_badge,1)]
df_holden[model:= word(model_badge,1,1)]
df_holden[,model:= word(model_badge,1,1)]
df_holden[,.N,model]
# Hyundai
df_Hyundai <- df_test[make=="Hyundai"]
df_Hyundai[,model:= word(model_badge,1,1)]
df_Hyundai[,.N,model]
# Jeep
df_Jeep <- df_test[make=="Jeep"]
View(df_Jeep)
df_Jeep[, model:= ifelse(str_detect(model_badge,"Grand Cherokee") == TRUE,
word(model_badge,1,2), word(model_badge,1))]
df_Jeep[,.N,model]
# Land Rover
df_LandRover <- df_test[make=="Land Rover"]
?str_detect
df_Jeep[, model:= ifelse(str_detect(model_badge,"Defender|Discovery") == TRUE,
word(model_badge,1,1),
ifelse(str_detect(model_badge,
"Discovery 4|Discovery Sport|
Freelander 2|Range Rover") == TRUE,
word(model_badge,1,2),  word(model_badge,1,3)))]
df_Jeep[,.N,model]
# BMW
df_bmw <- df_test[make=="BMW"]
df_bmw[, model:= ifelse(str_detect(model_badge,"Series") == TRUE,
word(model_badge,1,2), word(model_badge,1))]
df_bmw[,.N,model]
# Holden
df_holden <- df_test[make=="Holden"]
df_holden[,.N,model_badge]
df_holden[,model:= word(model_badge,1,1)]
df_holden[,.N,model]
# Hyundai
df_Hyundai <- df_test[make=="Hyundai"]
df_Hyundai[,model:= word(model_badge,1,1)]
df_Hyundai[,.N,model]
# Jeep
df_Jeep <- df_test[make=="Jeep"]
df_Jeep[, model:= ifelse(str_detect(model_badge,"Grand Cherokee") == TRUE,
word(model_badge,1,2), word(model_badge,1))]
df_Jeep[,.N,model]
df_LandRover <- df_test[make=="Land Rover"]
df_LandRover[, model:= ifelse(str_detect(model_badge,"Defender|Discovery") == TRUE,
word(model_badge,1,1),
ifelse(str_detect(model_badge,
"Discovery 4|Discovery Sport|
Freelander 2|Range Rover") == TRUE,
word(model_badge,1,2),  word(model_badge,1,3)))]
df_LandRover[,.N,model]
df_LandRover[, model:= ifelse(str_detect(model_badge,"Defender|Discovery") == TRUE,
word(model_badge,1,1),
ifelse(str_detect(model_badge,
"Discovery 4|Discovery Sport|
Freelander|Range Rover") == TRUE,
word(model_badge,1,2),  word(model_badge,1,3)))]
df_LandRover[,.N,model]
View(df_LandRover)
df_LandRover[, model:= ifelse(str_detect(model_badge,"Defender|Discovery") == TRUE,
word(model_badge,1,1),
ifelse(str_detect(model_badge,
"Discovery 4|Discovery Sport|
Freelander 2|Range Rover") == TRUE,
word(model_badge,1,3),  word(model_badge,1,2)))]
df_LandRover[,.N,model]
df_LandRover[, model:= ifelse(str_detect(model_badge,"Defender|Discovery") == TRUE,
word(model_badge,1,1),
ifelse(str_detect(model_badge,
"Discovery 4|Discovery Sport|
Freelander 2|Range Rover Evoque|Range Rover Sport|
Range Rover Velar|Range Rover Vogue") == TRUE,
word(model_badge,1,3),  word(model_badge,1,2)))]
df_LandRover[,.N,model]
# Mazda
df_Mazda <- df_test[make=="Mazda"]
df_Mazda[,model:= word(model_badge,1,1)]
View(df_Mazda)
df_Mazda[,.N,model]
# Mitsubishi
df_Mitsubishi <- df_test[make=="Mitsubishi"]
df_Mitsubishi[, model:= ifelse(str_detect(model_badge,"Pajero Sport|Eclipse Cross") == TRUE,
word(model_badge,1,2), word(model_badge,1))]
df_Mitsubishi[,.N,model]
# Nissan
df_Nissan <- df_test[make=="Nissan"]
# Nissan
df_Nissan <- df_test[make=="Nissan"]
View(df_Nissan)
df_Nissan[, model:= ifelse(str_detect(model_badge,"Titan XD") == TRUE,
word(model_badge,1,2), word(model_badge,1))]
df_Nissan[,.N,model]
# Subaru
df_Subaru <- df_test[make=="Subaru"]
df_Subaru[,model:= word(model_badge,1,1)]
df_Subaru[,.N,model]
# Toyota
df_Toyota <- df_test[make=="Toyota"]
df_Toyota[, model:= ifelse(str_detect(model_badge,"FJ Cruiser|Landcruiser Prado|Mark X|
Prius C|Prius V|Yaris Cross") == TRUE,
word(model_badge,1,2), word(model_badge,1))]
df_Toyota[,.N,model]
# Isuzu
df_Isuzu <- df_test[make=="Isuzu"]
df_Isuzu[, model:= ifelse(str_detect(model_badge,"F Series|N Series") == TRUE,
word(model_badge,1,2), word(model_badge,1))]
df_Isuzu[,.N,model]
# Mercedes-Benz
df_Mercedes_Benz <- df_test[make=="Mercedes-Benz"]
df_Isuzu[, model:= ifelse(str_detect(model_badge,"AMG|Marco Polo") == TRUE,
word(model_badge,1,2), word(model_badge,1))]
df_Isuzu <- df_test[make=="Isuzu"]
df_Isuzu[, model:= ifelse(str_detect(model_badge,"F Series|N Series") == TRUE,
word(model_badge,1,2), word(model_badge,1))]
df_Isuzu[,.N,model]
df_Mercedes_Benz[, model:= ifelse(str_detect(model_badge,"AMG|Marco Polo") == TRUE,
word(model_badge,1,2), word(model_badge,1))]
df_Mercedes_Benz[,.N,model]
View(df_Mercedes_Benz)
df_Mercedes_Benz[, model:= ifelse(str_detect(model_badge,"AMG|Marco Polo") == TRUE,
word(model_badge,1,2), word(model_badge,1,1))]
df_Mercedes_Benz[,.N,model]
benz_model <- ifelse(str_detect(df_Mercedes_Benz$model_badge,"AMG|Marco Polo") == TRUE,
word(model_badge,1,2), word(model_badge,1,1))]
benz_model <- ifelse(str_detect(df_Mercedes_Benz$model_badge,"AMG|Marco Polo") == TRUE,
word(df_Mercedes_Benz$model_badge,1,2), word(df_Mercedes_Benz$model_badge,1,1))]
benz_model <- ifelse(str_detect(df_Mercedes_Benz$model_badge,"AMG|Marco Polo") == TRUE,
word(df_Mercedes_Benz$model_badge,1,2), word(df_Mercedes_Benz$model_badge,1,1))
benz_model
ifelse(str_detect(benz_model,"Class"), word(benz_model,1,1), benz_model)
benz_model <- ifelse(str_detect(benz_model,"Class"), word(benz_model,1,1), benz_model)
unique(benz_model)
df_Mercedes_Benz[, model:= benz_model]
df_Mercedes_Benz[,.N,model]
# Volkswagen
df_Volkswagen <- df_test[make=="Volkswagen"]
df_Volkswagen[,model:= word(model_badge,1,1)]
df_Volkswagen[,.N,model]
df_all_models <- rbind(df_bmw,df_holden,df_Hyundai,df_Jeep,df_LandRover,df_Mazda,df_Mitsubishi,df_Nissan,df_Subaru,df_Toyota,df_Isuzu,df_Mercedes_Benz,df_Volkswagen)
View(df_all_models)
df_all_models[-8]
df_all_models <- df_all_models[-8]
df_all_models <- df_all_models[,-8]
df_all_models <- rbind(df_bmw,df_holden,df_Hyundai,df_Jeep,df_LandRover,df_Mazda,df_Mitsubishi,df_Nissan,df_Subaru,df_Toyota,df_Isuzu,df_Mercedes_Benz,df_Volkswagen)
df_all_models <- df_all_models[,-8]
fwrite(df_all_models,paste0(filepath,"df_all_31_08.csv"))
df <- fread(paste0(filepath,"df_all_31_08.csv"))
filepath <- "D:/Projects/EVE/Eve/"
library(data.table)
library(tidyverse)
df <- fread(paste0(filepath,"df_all_31_08.csv"))
View(df)
str(df)
# average price for makes
df %>%
group_by(make) %>%
mean(price_adj)
?mean
# average price for makes
df %>%
group_by(make)
# average price for makes
df %>%
group_by(make) %>%
ggplot(aes(x = year, y = price_adj, color = make))+
geom_line()
# average price for makes
df %>%
group_by(make) %>%
ggplot(aes(x = price_adj, y = make, color = make))+
geom_col()
# average price for makes
df %>%
group_by(make) %>%
ggplot(aes(x = mean(price_adj), y = make, color = make))+
geom_col()
?average
?mean
# average price for makes
df[,.(avg_price = mean(price_adj)), .(make, year)]
# average price for makes
df[,.(avg_price = mean(price_adj)), .(make)]
# average price for makes
df[!is.na(price_adj)]
# average price for makes
df_test <- df[!is.na(price_adj)]
df_test[,.(avg_price = mean(price_adj)), .(make)]
df[!is.na(price_adj)][,.(avg_price = mean(price_adj)), .(make)]
?product
df[!is.na(price_adj)][,.(avg_price = mean(price_adj)), .(make)] %>%
ggplot(aes(x = make, y = avg_price, color = make))+
geom_col()
df[!is.na(price_adj)][,.(avg_price = mean(price_adj)), .(make)] %>%
ggplot(aes(x = make, y = avg_price, color = make, fill = make))+
geom_col()
df[!is.na(price_adj)][,.(avg_price = mean(price_adj)), .(make)] %>%
ggplot(aes(x = make, y = avg_price, color = make, fill = make))+
geom_col()+
labs(x = "Makes", y = "Average price from 2011 to 2021", title = "Average price among the top 13 popular makes from year 2011 to 2021")
df[!is.na(price_adj)][,.(avg_price = mean(price_adj)), .(make)] %>%
ggplot(aes(x = make, y = avg_price, color = make, fill = make))+
geom_col()+
labs(x = "Makes", y = "Average price from 2011 to 2021", title = "Average price among the top 13 popular makes from year 2011 to 2021")+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5))
df[!is.na(price_adj)][,.(avg_price = mean(price_adj)), .(make)] %>%
ggplot(aes(x = make, y = avg_price, color = make, fill = make))+
geom_col()+
labs(x = "Makes", y = "Average price from 2011 to 2021", title = "Average price among the top 13 popular makes from year 2011 to 2021")+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
df_test[,.(avg_price = mean(price_adj)), .(make,year)]
df[!is.na(price_adj)][,.(avg_price = mean(price_adj)), .(make,year)]
df[!is.na(price_adj)][,.(avg_price = mean(price_adj)), .(make,year)]+
ggplot(aes(weight = avg_price, x = year, fill = make))+
geom_bar()
df[!is.na(price_adj)][,.(avg_price = mean(price_adj)), .(make,year)]+
ggplot(aes(weight = avg_price, x = year, fill = make))+
geom_col()
df[!is.na(price_adj)][,.(avg_price = mean(price_adj)), .(make,year)]+
ggplot(aes(y = avg_price, x = year, fill = make))+
geom_col()
df[!is.na(price_adj)][,.(avg_price = mean(price_adj)), .(make,year)]+
ggplot(aes(y = avg_price, x = year, group = make))+
geom_bar()
df[!is.na(price_adj)][,.(avg_price = mean(price_adj)), .(make,year)] %>%
ggplot(aes(weight = avg_price, x = year, group = make))+
geom_bar()
df[!is.na(price_adj)][,.(avg_price = mean(price_adj)), .(make,year)] %>%
ggplot(aes(weight = avg_price, x = year, fill = make))+
geom_bar()
df[!is.na(price_adj)][,.(avg_price = mean(price_adj)), .(make,year)]
avgprice_make_year <- df[!is.na(price_adj)][,.(avg_price = mean(price_adj)), .(make,year)]
avgprice_make_year %>%
ggplot(., aes(x = year, weight = avg_price, color = make))+
geom_bar(position = position_dodge())
avgprice_make_year %>%
ggplot(., aes(x = year, weight = avg_price, fill = make))+
geom_bar(position = position_dodge())
avgprice_make_year[make = "BMW"] %>%
ggplot(., aes(x = year, weight = avg_price, fill = make))+
geom_bar(position = position_dodge())
avgprice_make_year[make == "BMW"] %>%
ggplot(., aes(x = year, weight = avg_price, fill = make))+
geom_bar(position = position_dodge())
avgprice_make_year[make == "BMW|Land Rover|Mercedes-Benz"] %>%
ggplot(., aes(x = year, weight = avg_price, fill = make))+
geom_bar(position = position_dodge())
avgprice_make_year[make == "BMW|Land Rover|Mercedes-Benz"]
avgprice_make_year[make == .("BMW,Land Rover,Mercedes-Benz")] %>%
ggplot(., aes(x = year, weight = avg_price, fill = make))+
geom_bar(position = position_dodge())
avgprice_make_year[make == c("BMW,Land Rover,Mercedes-Benz")] %>%
ggplot(., aes(x = year, weight = avg_price, fill = make))+
geom_bar(position = position_dodge())
avgprice_make_year[make == c("BMW,Land Rover,Mercedes-Benz")]
avgprice_make_year[,make == c("BMW,Land Rover,Mercedes-Benz")]
avgprice_make_year[]
avgprice_make_year[make = "BMW"]
avgprice_make_year[make == "BMW"]
avgprice_make_year[make == "BMW"&"Land Rover"]
avgprice_make_year[make == .("BMW")]
avgprice_make_year[make == "BMW"|"Land Rover"]
avgprice_make_year[make == "BMW\Land Rover"]
avgprice_make_year[make == "BMW|Land Rover"]
avgprice_make_year[make == "BMW""Land Rover"]
avgprice_make_year[make == "BMW","Land Rover"]
avgprice_make_year[make == ("BMW","Land Rover")]
avgprice_make_year[make %in% c("BMW","Land Rover")]
avgprice_make_year[make %in% c("BMW","Land Rover")] %>%
ggplot(., aes(x = year, weight = avg_price, fill = make))+
geom_bar(position = position_dodge())
avgprice_make_year[make %in% c("BMW","Land Rover","Mercedes-Benz")] %>%
ggplot(., aes(x = year, weight = avg_price, fill = make))+
geom_bar(position = position_dodge())
df[!is.na(price_adj)][,.(avg_price = mean(price_adj)), .(make)] %>%
ggplot(aes(x = make, y = avg_price, color = make, fill = make))+
geom_col()+
labs(x = "Makes", y = "Average price from 2011 to 2021", title = "Average price among the top 13 popular makes from year 2011 to 2021")+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
df[!is.na(price_adj)][,.(avg_price = mean(price_adj)), .(make)] %>%
ggplot(aes(x = make, y = avg_price, color = make, fill = make))+
geom_col()+
labs(x = "Makes", y = "Average price from 2011 to 2021", title = "Average price among the top 13 popular makes from year 2011 to 2021")+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
# compare the three most expensive makes
avgprice_make_year <- df[!is.na(price_adj)][,.(avg_price = mean(price_adj)), .(make,year)]
avgprice_make_year[make %in% c("BMW","Land Rover","Mercedes-Benz")] %>%
ggplot(., aes(x = year, weight = avg_price, fill = make))+
geom_bar(position = position_dodge())
avgprice_make_year[make %in% c("BMW","Land Rover","Mercedes-Benz")] %>%
ggplot(., aes(x = year, weight = avg_price, fill = make))+
geom_bar(position = position_dodge())+
labs(x ="Years", y = "Average price", title = "Changes of average price from year 2011 to 2021 between BMW, Land Rover and Mercedes_Benz")
avgprice_make_year[make %in% c("BMW","Land Rover","Mercedes-Benz")]
avgprice_make_year[make %in% c("BMW","Land Rover","Mercedes-Benz")] %>%
ggplot(., aes(x = year, weight = avg_price, fill = make))+
geom_bar(position = position_dodge())+
labs(x ="Years", y = "Average price", title = "Changes of average price from year 2011 to 2021 between BMW, Land Rover and Mercedes_Benz")
?median
## median price
medprice_make_year <- df[!is.na(price_adj)][,.(med_price = median(price_adj)), .(make,year)]
medprice_make_year
medprice_make_year[make %in% c("BMW","Land Rover","Mercedes-Benz")] %>%
ggplot(., aes(x = year, weight = avg_price, fill = make))+
geom_bar(position = position_dodge())+
labs(x ="Years", y = "Average price", title = "Changes of average price from year 2011 to 2021 between BMW, Land Rover and Mercedes_Benz")
medprice_make_year[make %in% c("BMW","Land Rover","Mercedes-Benz")] %>%
ggplot(., aes(x = year, weight = med_price, fill = make))+
geom_bar(position = position_dodge())+
labs(x ="Years", y = "Median price", title = "Changes of Median price from year 2011 to 2021 between BMW, Land Rover and Mercedes_Benz")
df[!is.na(price_adj)][make %in% c("BMW","Land Rover","Mercedes-Benz")]
medprice_make_year[make %in% c("BMW","Land Rover","Mercedes-Benz")] %>%
ggplot(., aes(x = year, weight = med_price, fill = make))+
geom_bar(position = position_dodge())+
labs(x ="Years", y = "Median price", title = "Changes of Median price from year 2011 to 2021 between BMW, Land Rover and Mercedes_Benz")
df[!is.na(price_adj)][make %in% c("BMW","Land Rover","Mercedes-Benz")] %>%
ggplot(.,aes(x = year, weight = price, color = make))+
geom_boxplot()
df[!is.na(price_adj)][make %in% c("BMW","Land Rover","Mercedes-Benz")] %>%
ggplot(.,aes(x = year, weight = price_agj, color = make))+
geom_boxplot()
df[!is.na(price_adj)][make %in% c("BMW","Land Rover","Mercedes-Benz")] %>%
ggplot(.,aes(x = year, weight = price_adj, color = make))+
geom_boxplot()
df[!is.na(price_adj)][make %in% c("BMW","Land Rover","Mercedes-Benz")] %>%
ggplot(.,aes(x = year, y = price_adj, color = make))+
geom_boxplot()
df[!is.na(price_adj)][make %in% c("BMW","Land Rover","Mercedes-Benz")] %>%
ggplot(.,aes(x = make, y = price_adj, color = make))+
geom_boxplot()
## Box plot for three makes
df[!is.na(price_adj)][make %in% c("BMW","Land Rover","Mercedes-Benz")] %>%
ggplot(.,aes(x = make, y = price_adj, color = make))+
geom_boxplot()+
labs(x ="Mkaes", y = "Price", title = "Distribution of prices from year 2011 to 2021 between BMW, Land Rover and Mercedes_Benz")
# compare the three most expensive makes
## average price
avgprice_make_year <- df[!is.na(price_adj)][,.(avg_price = mean(price_adj)), .(make,year)]
avgprice_make_year[make %in% c("BMW","Land Rover","Mercedes-Benz")] %>%
ggplot(., aes(x = year, weight = avg_price, fill = make))+
geom_bar(position = position_dodge())+
labs(x ="Years", y = "Average price", title = "Changes of average price from year 2011 to 2021 between BMW, Land Rover and Mercedes_Benz")
## median price
medprice_make_year <- df[!is.na(price_adj)][,.(med_price = median(price_adj)), .(make,year)]
medprice_make_year[make %in% c("BMW","Land Rover","Mercedes-Benz")] %>%
ggplot(., aes(x = year, weight = med_price, fill = make))+
geom_bar(position = position_dodge())+
labs(x ="Years", y = "Median price", title = "Changes of Median price from year 2011 to 2021 between BMW, Land Rover and Mercedes_Benz")
## Box plot for three makes
df[!is.na(price_adj)][make %in% c("BMW","Land Rover","Mercedes-Benz")] %>%
ggplot(.,aes(x = make, y = price_adj, color = make))+
geom_boxplot()+
labs(x ="Mkaes", y = "Price", title = "Distribution of prices from year 2011 to 2021 between BMW, Land Rover and Mercedes_Benz")
avgprice_make_year[make %in% c("Isuzu","Jeep","Toyota","Nissan","Volkswagen")] %>%
ggplot(., aes(x = year, weight = avg_price, fill = make))+
geom_bar(position = position_dodge())+
labs(x ="Years", y = "Average price", title = "Changes of Average price from year 2011 to 2021 between BMW, Land Rover and Mercedes_Benz")
avgprice_make_year[make %in% c("Isuzu","Jeep","Toyota","Nissan","Volkswagen")] %>%
ggplot(., aes(x = year, weight = avg_price, fill = make))+
geom_bar(position = position_dodge())+
labs(x ="Years", y = "Average price", title = "Changes of Average price from year 2011 to 2021 between Isuzu, Jeep, Toyota, Nissan and Volkswagen")
medprice_make_year[make %in% c("Isuzu","Jeep","Toyota","Nissan","Volkswagen")] %>%
ggplot(., aes(x = year, weight = med_price, fill = make))+
geom_bar(position = position_dodge())+
labs(x ="Years", y = "Median price", title = "Changes of Median price from year 2011 to 2021 between Isuzu, Jeep, Toyota, Nissan and Volkswagen")
## Box plot for three makes
df[!is.na(price_adj)][make %in% c("Isuzu","Jeep","Toyota","Nissan","Volkswagen")] %>%
ggplot(.,aes(x = make, y = price_adj, color = make))+
geom_boxplot()+
labs(x ="Mkaes", y = "Price", title = "Distribution of prices from year 2011 to 2021 between Isuzu, Jeep, Toyota, Nissan and Volkswagen")
# compare "Isuzu","Jeep","Toyota","Nissan","Volkswagen"
## average price
avgprice_make_year <- df[!is.na(price_adj)][,.(avg_price = mean(price_adj)), .(make,year)]
avgprice_make_year[make %in% c("Isuzu","Jeep","Toyota","Nissan","Volkswagen")] %>%
ggplot(., aes(x = year, weight = avg_price, fill = make))+
geom_bar(position = position_dodge())+
labs(x ="Years", y = "Average price", title = "Changes of Average price from year 2011 to 2021 between Isuzu, Jeep, Toyota, Nissan and Volkswagen")
## median price
medprice_make_year <- df[!is.na(price_adj)][,.(med_price = median(price_adj)), .(make,year)]
medprice_make_year[make %in% c("Isuzu","Jeep","Toyota","Nissan","Volkswagen")] %>%
ggplot(., aes(x = year, weight = med_price, fill = make))+
geom_bar(position = position_dodge())+
labs(x ="Years", y = "Median price", title = "Changes of Median price from year 2011 to 2021 between Isuzu, Jeep, Toyota, Nissan and Volkswagen")
## Box plot for three makes
df[!is.na(price_adj)][make %in% c("Isuzu","Jeep","Toyota","Nissan","Volkswagen")] %>%
ggplot(.,aes(x = make, y = price_adj, color = make))+
geom_boxplot()+
labs(x ="Mkaes", y = "Price", title = "Distribution of prices from year 2011 to 2021 between Isuzu, Jeep, Toyota, Nissan and Volkswagen")
# compare "Subaru", "Mitsubishi", "Mazda", "Holden", "Hyundai"
## average price
avgprice_make_year <- df[!is.na(price_adj)][,.(avg_price = mean(price_adj)), .(make,year)]
avgprice_make_year[make %in% c("Subaru", "Mitsubishi", "Mazda", "Holden", "Hyundai")] %>%
ggplot(., aes(x = year, weight = avg_price, fill = make))+
geom_bar(position = position_dodge())+
labs(x ="Years", y = "Average price", title = "Changes of Average price from year 2011 to 2021 between Subaru, Mitsubishi, Mazda, Holden and Hyundai")
## median price
medprice_make_year <- df[!is.na(price_adj)][,.(med_price = median(price_adj)), .(make,year)]
medprice_make_year[make %in% c("Subaru", "Mitsubishi", "Mazda", "Holden", "Hyundai")] %>%
ggplot(., aes(x = year, weight = med_price, fill = make))+
geom_bar(position = position_dodge())+
labs(x ="Years", y = "Median price", title = "Changes of Median price from year 2011 to 2021 between Subaru, Mitsubishi, Mazda, Holden and Hyundai")
## Box plot for three makes
df[!is.na(price_adj)][make %in% c("Subaru", "Mitsubishi", "Mazda", "Holden", "Hyundai")] %>%
ggplot(.,aes(x = make, y = price_adj, color = make))+
geom_boxplot()+
labs(x ="Mkaes", y = "Price", title = "Distribution of prices from year 2011 to 2021 between Subaru, Mitsubishi, Mazda, Holden and Hyundai")
## Box plot for three makes
df[!is.na(price_adj)] %>%
ggplot(.,aes(x = make, y = price_adj, color = make))+
geom_boxplot()+
labs(x ="Makes", y = "Price", title = "Distribution of prices from year 2011 to 2021 between all 13 makes")
## Box plot for three makes
df[!is.na(price_adj)] %>%
ggplot(.,aes(x = make, y = price_adj, color = make))+
geom_boxplot()+
labs(x ="Makes", y = "Price", title = "Distribution of prices from year 2011 to 2021 between all 13 makes")+
theme(axis.text.x = element_text(angle = 90))
## Box plot for three makes
df[!is.na(price_adj)] %>%
ggplot(.,aes(x = make, y = price_adj, color = make))+
geom_boxplot()+
labs(x ="Makes", y = "Price", title = "Distribution of prices from year 2011 to 2021 between all 13 makes")+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
# median price
df[!is.na(price_adj)][,.(med_price = median(price_adj)), .(make)] %>%
ggplot(aes(x = make, y = med_price, color = make, fill = make))+
geom_col()+
labs(x = "Makes", y = "Median price from 2011 to 2021", title = "Median price among the top 13 popular makes from year 2011 to 2021")+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
df[!is.na(price_adj)][,.(avg_price = mean(price_adj)), .(make)] %>%
ggplot(aes(x = make, y = avg_price, color = make, fill = make))+
geom_col()+
labs(x = "Makes", y = "Average price from 2011 to 2021", title = "Average price among the top 13 popular makes from year 2011 to 2021")+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
# median price
df[!is.na(price_adj)][,.(med_price = median(price_adj)), .(make)] %>%
ggplot(aes(x = make, y = med_price, color = make, fill = make))+
geom_col()+
labs(x = "Makes", y = "Median price from 2011 to 2021", title = "Median price among the top 13 popular makes from year 2011 to 2021")+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
# BMW "Land Rover" "Mercedes-Benz"
# "Isuzu" "Jeep" Toyota" "Nissan" "Volkswagen"
#  "Subaru", "Mitsubishi", "Mazda", "Holden", "Hyundai"
# compare "Isuzu","Jeep","Toyota","Nissan","Volkswagen"
## average price
avgprice_make_year <- df[!is.na(price_adj)][,.(avg_price = mean(price_adj)), .(make,year)]
avgprice_make_year[make %in% c("Isuzu","Jeep","Toyota","Nissan","Volkswagen")] %>%
ggplot(., aes(x = year, weight = avg_price, fill = make))+
geom_bar(position = position_dodge())+
labs(x ="Years", y = "Average price", title = "Changes of Average price from year 2011 to 2021 between Isuzu, Jeep, Toyota, Nissan and Volkswagen")
## median price
medprice_make_year <- df[!is.na(price_adj)][,.(med_price = median(price_adj)), .(make,year)]
medprice_make_year[make %in% c("Isuzu","Jeep","Toyota","Nissan","Volkswagen")] %>%
ggplot(., aes(x = year, weight = med_price, fill = make))+
geom_bar(position = position_dodge())+
labs(x ="Years", y = "Median price", title = "Changes of Median price from year 2011 to 2021 between Isuzu, Jeep, Toyota, Nissan and Volkswagen")
## Box plot for three makes
df[!is.na(price_adj)][make %in% c("Isuzu","Jeep","Toyota","Nissan","Volkswagen")] %>%
ggplot(.,aes(x = make, y = price_adj, color = make))+
geom_boxplot()+
labs(x ="Makes", y = "Price", title = "Distribution of prices from year 2011 to 2021 between Isuzu, Jeep, Toyota, Nissan and Volkswagen")
View(df)
View(df_test)
# compare "Subaru", "Mitsubishi", "Mazda", "Holden", "Hyundai"
## average price
avgprice_make_year <- df[!is.na(price_adj)][,.(avg_price = mean(price_adj)), .(make,year)]
avgprice_make_year[make %in% c("Subaru", "Mitsubishi", "Mazda", "Holden", "Hyundai")] %>%
ggplot(., aes(x = year, weight = avg_price, fill = make))+
geom_bar(position = position_dodge())+
labs(x ="Model Years", y = "Average price", title = "Changes of Average price from year 2011 to 2021 between Subaru, Mitsubishi, Mazda, Holden and Hyundai")
## median price
medprice_make_year <- df[!is.na(price_adj)][,.(med_price = median(price_adj)), .(make,year)]
medprice_make_year[make %in% c("Subaru", "Mitsubishi", "Mazda", "Holden", "Hyundai")] %>%
ggplot(., aes(x = year, weight = med_price, fill = make))+
geom_bar(position = position_dodge())+
labs(x ="Model Years", y = "Median price", title = "Changes of Median price from year 2011 to 2021 between Subaru, Mitsubishi, Mazda, Holden and Hyundai")
## Box plot for three makes
df[!is.na(price_adj)][make %in% c("Subaru", "Mitsubishi", "Mazda", "Holden", "Hyundai")] %>%
ggplot(.,aes(x = make, y = price_adj, color = make))+
geom_boxplot()+
labs(x ="Makes", y = "Price", title = "Distribution of prices from year 2011 to 2021 between Subaru, Mitsubishi, Mazda, Holden and Hyundai")
df[!is.na(price_adj)][make %in% c("Isuzu","Jeep","Toyota","Nissan","Volkswagen")]
# compare "Isuzu","Jeep","Toyota","Nissan","Volkswagen"
## average price
avgprice_make_year <- df[!is.na(price_adj)][,.(avg_price = mean(price_adj)), .(make,year)]
avgprice_make_year[make %in% c("Isuzu","Jeep","Toyota","Nissan","Volkswagen")] %>%
ggplot(., aes(x = year, weight = avg_price, fill = make))+
geom_bar(position = position_dodge())+
labs(x ="Model Years", y = "Average price", title = "Changes of Average price from year 2011 to 2021 between Isuzu, Jeep, Toyota, Nissan and Volkswagen")
## median price
medprice_make_year <- df[!is.na(price_adj)][,.(med_price = median(price_adj)), .(make,year)]
medprice_make_year[make %in% c("Isuzu","Jeep","Toyota","Nissan","Volkswagen")] %>%
ggplot(., aes(x = year, weight = med_price, fill = make))+
geom_bar(position = position_dodge())+
labs(x ="Model Years", y = "Median price", title = "Changes of Median price from year 2011 to 2021 between Isuzu, Jeep, Toyota, Nissan and Volkswagen")
## Box plot for three makes
df[!is.na(price_adj)][make %in% c("Isuzu","Jeep","Toyota","Nissan","Volkswagen")] %>%
ggplot(.,aes(x = make, y = price_adj, color = make))+
geom_boxplot()+
labs(x ="Makes", y = "Price", title = "Distribution of prices from year 2011 to 2021 between Isuzu, Jeep, Toyota, Nissan and Volkswagen")
