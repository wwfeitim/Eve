gg_changes <- ggplot(df_change)+
geom_col_interactive(aes(x = body_adj, y = change, tooltip = change, data_id = change, fill = body_adj))+
labs(x = "Body type", y = "Median Price", title = "% changes of med price  between MY20&21 and older MY", fill = "Body Type") +
scale_fill_brewer(palette = "Paired")+
theme(axis.text.x = element_text(angle = 90, vjust =0.5))+
scale_y_continuous(labels = percent)
girafe(ggobj = gg_changes)
gg_changes <- ggplot(df_change)+
geom_col_interactive(aes(x = body_adj, y = change, tooltip = change, data_id = change, fill = body_adj))+
labs(x = "Body type", y = "Median Price % change", title = "% changes of med price  between MY20&21 and older MY", fill = "Body Type") +
scale_fill_brewer(palette = "Paired")+
theme(axis.text.x = element_text(angle = 90, vjust =0.5))+
scale_y_continuous(labels = percent)
girafe(ggobj = gg_changes)
girafe(ggobj = gg_mazda_body_medP)
girafe(ggobj = gg_volkswagen_body_model_medP)
girafe(ggobj = gg_volkswagen_body_medP)
df_volkswagen %>%
ggplot()+
geom_boxplot_interactive(aes(
x = body_adj, y = price_adj, fill = body_adj, tooltip = body_adj, data_id = body_adj
))
girafe(ggobj = gg_volkswagen_body_model_medP)
df_volkswagen %>%
ggplot()+
geom_boxplot_interactive(aes(
x = body_adj, y = price_adj, fill = body_adj, tooltip = body_adj, data_id = body_adj
)) +
labs(x = "Body type", y = "Median Price", title = "Volkswagen median price of each body type", fill = "Body Type") +
scale_fill_brewer(palette = "Paired")+# try palette
theme(axis.text.x = element_text(angle = 90, vjust =0.5))+
scale_y_continuous(labels = comma) # change y axis number format
gg_box_volkswagen_medp_body <- df_volkswagen %>%
ggplot()+
geom_boxplot_interactive(aes(
x = body_adj, y = price_adj, fill = body_adj, tooltip = body_adj, data_id = body_adj
)) +
labs(x = "Body type", y = "Median Price", title = "Volkswagen median price of each body type", fill = "Body Type") +
scale_fill_brewer(palette = "Paired")+# try palette
theme(axis.text.x = element_text(angle = 90, vjust =0.5))+
scale_y_continuous(labels = comma) # change y axis number format
girafe(ggobj = gg_box_volkswagen_medp_body)
df_volkswagen[body_adj %in% c("Convertible", "Coupe "), .N, year]
girafe(ggobj = gg_volkswagen_body_model_medP)
gg_box_Toyota_medp_body <- df_toyota %>%
ggplot()+
geom_boxplot_interactive(aes(
x = body_adj, y = price_adj, fill = body_adj, tooltip = body_adj, data_id = body_adj
)) +
labs(x = "Body type", y = "Median Price", title = "Toyota median price of each body type", fill = "Body Type") +
scale_fill_brewer(palette = "Paired")+# try palette
theme(axis.text.x = element_text(angle = 90, vjust =0.5))+
scale_y_continuous(labels = comma) # change y axis number format
girafe(ggobj = gg_box_Toyota_medp_body)
girafe(ggobj = gg_toyota_body_medP)
girafe(ggobj = gg_box_Toyota_medp_body)
df_toyota[, .(medprice = median(price_adj)), year]
df_test[!make == "Toyota"]
df_test[!make == "Toyota", .(medprice = median(price_adj)), year]
df_toyota[, .(medprice = median(price_adj)), year]
df_test[!make == "Toyota", .(medprice = median(price_adj)), year]
df_toyota[, .(meanprice = mean(price_adj)), year]
df_test[!make == "Toyota", .(meanprice = mean(price_adj)), year]
df_toyota[, .(meanprice_toyota = mean(price_adj)), year]
df_test[!make == "Toyota", .(meanprice_exclud_toyota = mean(price_adj)), year]
df_meanp_exc_toyota <- df_test[!make == "Toyota", .(meanprice_exclud_toyota = mean(price_adj)), year]
df_meanp_toyota <- df_toyota[, .(meanprice_toyota = mean(price_adj)), year]
df_meanp <- merge(df_meanp_toyota, df_meanp_exc_toyota)
df_meanp
df_meanp %>%
ggplot()+
geom_line(aes(
x = year, y = meanprice_toyota
))
df_meanp %>%
ggplot()+
geom_line(aes(
x = year, y = meanprice_toyota
))+
scale_x_continuous(breaks = seq(2011,2021,1))
df_meanp %>%
ggplot()+
geom_line(aes(
x = year, y = meanprice_toyota, color = "red"
))+
scale_x_continuous(breaks = seq(2011,2021,1))
df_meanp %>%
ggplot()+
geom_line(aes(
x = year, y = meanprice_toyota, color = "Toyota"
))+
scale_x_continuous(breaks = seq(2011,2021,1))
df_meanp
df_meanp %>%
ggplot()+
geom_line(aes(
x = year, y = meanprice_toyota, color = "Toyota"
))+
geom_line(aes(y = meanprice_exclud_toyota, color = "Others"))+
scale_x_continuous(breaks = seq(2011,2021,1))
df_meanp %>%
ggplot()+
geom_line(aes(
x = year, y = meanprice_toyota, color = "Toyota"
))+
geom_line(aes(x = year, y = meanprice_exclud_toyota, color = "Others"))+
scale_x_continuous(breaks = seq(2011,2021,1))
df_meanp %>%
ggplot()+
geom_line(aes(
x = year, y = meanprice_toyota, color = "Toyota"
))+
geom_point_interactive(aes(
x = year, y = meanprice_toyota, color = "Toyota"
))+
geom_line(aes(x = year, y = meanprice_exclud_toyota, color = "Others"))+
scale_x_continuous(breaks = seq(2011,2021,1))
df_meanp %>%
ggplot()+
geom_line(aes(
x = year, y = meanprice_toyota, color = "Toyota"
))+
geom_point_interactive(aes(
x = year, y = meanprice_toyota, color = "Toyota", tooltip = meanprice_toyota, data_id = meanprice_toyota
))+
geom_line(aes(x = year, y = meanprice_exclud_toyota, color = "Others"))+
scale_x_continuous(breaks = seq(2011,2021,1))
df_meanp %>%
ggplot()+
geom_line(aes(
x = year, y = meanprice_toyota, color = "Toyota"
))+
geom_point_interactive(aes(
x = year, y = meanprice_toyota, color = "Toyota", tooltip = meanprice_toyota, data_id = meanprice_toyota
))+
geom_line(aes(x = year, y = meanprice_exclud_toyota, color = "Others"))+
geom_point_interactive(aes(
x = year, y = meanprice_exclud_toyota, color = "Others", tooltip = meanprice_exclud_toyota, data_id = meanprice_exclud_toyota
))+
scale_x_continuous(breaks = seq(2011,2021,1))
df_meanp %>%
ggplot()+
geom_line(aes(
x = year, y = meanprice_toyota, color = "Toyota"
))+
geom_point_interactive(aes(
x = year, y = meanprice_toyota, color = "Toyota", tooltip = meanprice_toyota, data_id = meanprice_toyota
))+
geom_line(aes(x = year, y = meanprice_exclud_toyota, color = "Others"))+
geom_point_interactive(aes(
x = year, y = meanprice_exclud_toyota, color = "Others", tooltip = meanprice_exclud_toyota, data_id = meanprice_exclud_toyota
))+
scale_x_continuous(breaks = seq(2011,2021,1))+
labs(x = "Model Years", y = "Mean Prices", title = "Mean Prices of Toyota and others")
df_meanp %>%
ggplot()+
geom_line(aes(
x = year, y = meanprice_toyota, color = "Toyota"
))+
geom_point_interactive(aes(
x = year, y = meanprice_toyota, color = "Toyota", tooltip = meanprice_toyota, data_id = meanprice_toyota
))+
geom_line(aes(x = year, y = meanprice_exclud_toyota, color = "Others"))+
geom_point_interactive(aes(
x = year, y = meanprice_exclud_toyota, color = "Others", tooltip = meanprice_exclud_toyota, data_id = meanprice_exclud_toyota
))+
scale_x_continuous(breaks = seq(2011,2021,1))+
labs(x = "Model Years", y = "Mean Prices", title = "Mean Prices of Toyota and other Brands")
gg_meanprice_compare <- df_meanp %>%
ggplot()+
geom_line(aes(
x = year, y = meanprice_toyota, color = "Toyota"
))+
geom_point_interactive(aes(
x = year, y = meanprice_toyota, color = "Toyota", tooltip = meanprice_toyota, data_id = meanprice_toyota
))+
geom_line(aes(x = year, y = meanprice_exclud_toyota, color = "Others"))+
geom_point_interactive(aes(
x = year, y = meanprice_exclud_toyota, color = "Others", tooltip = meanprice_exclud_toyota, data_id = meanprice_exclud_toyota
))+
scale_x_continuous(breaks = seq(2011,2021,1))+
labs(x = "Model Years", y = "Mean Prices", title = "Mean Prices of Toyota and other Brands")
girafe(ggobj = gg_meanprice_compare)
gg_meanprice_compare <- df_meanp %>%
ggplot()+
geom_line(aes(
x = year, y = meanprice_toyota, color = "Toyota"
))+
geom_point_interactive(aes(
x = year, y = meanprice_toyota, color = "Toyota", tooltip = meanprice_toyota, data_id = meanprice_toyota
))+
geom_line(aes(x = year, y = meanprice_exclud_toyota, color = "Others"))+
geom_point_interactive(aes(
x = year, y = meanprice_exclud_toyota, color = "Others", tooltip = meanprice_exclud_toyota, data_id = meanprice_exclud_toyota
))+
scale_x_continuous(breaks = seq(2011,2021,1))+
labs(x = "Model Years", y = "Mean Prices", title = "Mean Prices of Toyota and other Brands in Australia")
girafe(ggobj = gg_meanprice_compare)
gg_meanprice_compare <- df_meanp %>%
ggplot()+
geom_line(aes(
x = year, y = meanprice_toyota, color = "Toyota"
))+
geom_point_interactive(aes(
x = year, y = meanprice_toyota, color = "Toyota", tooltip = meanprice_toyota, data_id = meanprice_toyota
))+
geom_line(aes(x = year, y = meanprice_exclud_toyota, color = "Others"))+
geom_point_interactive(aes(
x = year, y = meanprice_exclud_toyota, color = "Others", tooltip = meanprice_exclud_toyota, data_id = meanprice_exclud_toyota
))+
scale_x_continuous(breaks = seq(2011,2021,1))+
labs(x = "Model Years", y = "Mean Prices", title = "Mean Prices of Toyota and other Brands in Australia", fill = "Brand")
girafe(ggobj = gg_meanprice_compare)
gg_meanprice_compare <- df_meanp %>%
ggplot()+
geom_line(aes(
x = year, y = meanprice_toyota, color = "Toyota"
))+
geom_point_interactive(aes(
x = year, y = meanprice_toyota, color = "Toyota", tooltip = meanprice_toyota, data_id = meanprice_toyota
))+
geom_line(aes(x = year, y = meanprice_exclud_toyota, color = "Others"))+
geom_point_interactive(aes(
x = year, y = meanprice_exclud_toyota, color = "Others", tooltip = meanprice_exclud_toyota, data_id = meanprice_exclud_toyota
))+
scale_x_continuous(breaks = seq(2011,2021,1))+
labs(x = "Model Years", y = "Mean Prices", title = "Mean Prices of Toyota and other Brands in Australia", fill = "Brand")
girafe(ggobj = gg_meanprice_compare)
gg_meanprice_compare <- df_meanp %>%
ggplot()+
geom_line(aes(
x = year, y = meanprice_toyota, color = "Toyota"
))+
geom_point_interactive(aes(
x = year, y = meanprice_toyota, color = "Toyota", tooltip = meanprice_toyota, data_id = meanprice_toyota
))+
geom_line(aes(x = year, y = meanprice_exclud_toyota, color = "Others"))+
geom_point_interactive(aes(
x = year, y = meanprice_exclud_toyota, color = "Others", tooltip = meanprice_exclud_toyota, data_id = meanprice_exclud_toyota
))+
scale_x_continuous(breaks = seq(2011,2021,1))+
labs(x = "Model Years", y = "Mean Prices", title = "Mean Prices of Toyota and other Brands in Australia", color = "Brand")
girafe(ggobj = gg_meanprice_compare)
girafe(ggobj = gg_toyota_body_model_medP)
girafe(ggobj = gg_meanprice_compare)
df_test[!seller_ad = "incorrect seller"]
df_test[!seller_ad == "incorrect seller"]
df_test[!seller_ad == "incorrect seller", .(meanprice = mean(price_adj)), .(seller_ad)]
df_test[!seller_ad == "incorrect seller"] %>%
ggplot()+
geom_boxplot_interactive(aes(
x = seller_ad, y = price_adj, fill = seller_ad, tooltip = seller_ad, data_id = seller_ad
))
gg_seller <- df_test[!seller_ad == "incorrect seller"] %>%
ggplot()+
geom_boxplot_interactive(aes(
x = seller_ad, y = price_adj, fill = seller_ad, tooltip = seller_ad, data_id = seller_ad
))+
labs(x = "Seller", y = "Price", title = "Price made between dealer and private", fill = "Seller") +
scale_fill_brewer(palette = "Paired")+
theme(axis.text.x = element_text(angle = 90, vjust =0.5))+
scale_y_continuous(labels = comma, breaks = seq(0,470000,50000))
girafe(ggobj = gg_seller)
View(df_test)
df_test[, .(averagprice = mean(price_adj)), .(state_only)]
library(data.table)
library(tidyverse)
library(ggiraph)
library(scales)
filepath <- "D:/Projects/EVE/Eve/"
df <- fread(paste0(filepath,"df_all_31_08.csv"))
df_test <- df
df_test <- df_test[!title %in% c("",is.na(title))] # check blank and NA
df_test[, .(averagprice = mean(price_adj)), .(state_only)]
df_test[, .(averagprice = mean(price_adj)), .(state_only)][order(-averageprice)]
df_test[, .(averagprice = mean(price_adj)), .(state_only)][order(-averagprice)]
df_test[!state_only == "", .(averagprice = mean(price_adj)), .(state_only)][order(-averagprice)]
df_test[!state_only == "", .(averagprice = mean(price_adj), medprice = median(price_adj)), .(state_only)][order(-averagprice)]
df_states <- df_test[!state_only == "", .(averagprice = mean(price_adj), medprice = median(price_adj)), .(state_only)][order(-averagprice)]
df_states[, .(avg_rate := averagprice/min(averagprice))]
df_states[, avg_rate := averagprice/min(averagprice)]
df_states
df_states[, avg_rate := averagprice/min(averagprice)][, med_rate := medprice/min(medprice)]
df_states
df_test[state_only == ""]
df_test[!state_only == ""]
df_states
df_states[, avg_rate := averagprice/min(averagprice)][, med_rate := medprice/min(medprice)] %>%
ggplot(aes(x = state_only, y = averagprice))+
geom_col_interactive()
df_states[, avg_rate := averagprice/min(averagprice)][, med_rate := medprice/min(medprice)] %>%
ggplot(aes(x = state_only, y = averagprice))+
geom_col_interactive()+
geom_line(aes(weight = avg_rate))
df_states[, avg_rate := averagprice/min(averagprice)][, med_rate := medprice/min(medprice)] %>%
ggplot(aes(x = state_only, y = averagprice))+
geom_col_interactive()+
geom_line(aes(y = avg_rate))
df_states[, avg_rate := averagprice/min(averagprice)][, med_rate := medprice/min(medprice)] %>%
ggplot(aes(x = state_only, y = averagprice))+
geom_col_interactive()+
geom_line(aes(y = avg_rate, group = 1))
df_states[, avg_rate := averagprice/min(averagprice)][, med_rate := medprice/min(medprice)] %>%
ggplot(aes(x = state_only, y = averagprice))+
geom_col_interactive()+
geom_line(aes(y = avg_rate, group = state_only))
df_states[, avg_rate := averagprice/min(averagprice)][, med_rate := medprice/min(medprice)] %>%
ggplot(aes(x = state_only, y = averagprice))+
geom_col_interactive(aes(fill = state_only))+
geom_line(aes(z = avg_rate))
df_states[, avg_rate := averagprice/min(averagprice)][, med_rate := medprice/min(medprice)] %>%
ggplot(aes(x = state_only, y = averagprice))+
geom_col_interactive(aes(fill = state_only))+
geom_line(aes(label = avg_rate))
df_states
View(df_states)
df_states[, avg_rate := averagprice/min(averagprice)][, med_rate := medprice/min(medprice)] %>%
ggplot(aes(x = state_only, y = averagprice))+
geom_col_interactive(aes(fill = state_only))+
scale_fill_brewer(palette = "paired")
df_states[, avg_rate := averagprice/min(averagprice)][, med_rate := medprice/min(medprice)] %>%
ggplot(aes(x = state_only, y = averagprice))+
geom_col_interactive(aes(fill = state_only))+
scale_fill_brewer(palette = "Paired")
df_states[, avg_rate := averagprice/min(averagprice)][, med_rate := medprice/min(medprice)] %>%
ggplot(aes(x = state_only, y = averagprice))+
geom_col_interactive(aes(fill = state_only))+
scale_fill_brewer(palette = "Paired")+
scale_y_continuous(labels = comma, breaks = seq(30000,45000,2500))
df_states[, avg_rate := averagprice/min(averagprice)][, med_rate := medprice/min(medprice)] %>%
ggplot(aes(x = state_only, y = averagprice))+
geom_col_interactive(aes(fill = state_only))+
scale_fill_brewer(palette = "Paired")+
ylim(30000, 45000)+
scale_y_continuous(labels = comma, breaks = seq(30000,45000,2500))
df_states[, avg_rate := averagprice/min(averagprice)][, med_rate := medprice/min(medprice)] %>%
ggplot(aes(x = state_only, y = averagprice))+
geom_col_interactive(aes(fill = state_only))+
scale_fill_brewer(palette = "Paired")+
ylim(30000, 45000)+
scale_y_continuous(labels = comma)
df_states[, avg_rate := averagprice/min(averagprice)][, med_rate := medprice/min(medprice)] %>%
ggplot(aes(x = state_only, y = averagprice))+
geom_col_interactive(aes(fill = state_only))+
scale_fill_brewer(palette = "Paired")+
ylim(30000, 45000)
df_states[, avg_rate := averagprice/min(averagprice)][, med_rate := medprice/min(medprice)] %>%
ggplot(aes(x = state_only, y = averagprice))+
geom_col_interactive(aes(fill = state_only))+
scale_fill_brewer(palette = "Paired")+
scale_y_continuous(labels = comma, limits = seq(30000,45000,))
df_states[, avg_rate := averagprice/min(averagprice)][, med_rate := medprice/min(medprice)] %>%
ggplot(aes(x = state_only, y = averagprice))+
geom_col_interactive(aes(fill = state_only))+
scale_fill_brewer(palette = "Paired")+
scale_y_continuous(labels = comma, limits = 30000)
df_states[, avg_rate := averagprice/min(averagprice)][, med_rate := medprice/min(medprice)] %>%
ggplot(aes(x = state_only, y = averagprice))+
geom_col_interactive(aes(fill = state_only))+
scale_fill_brewer(palette = "Paired")+
scale_y_continuous(labels = comma, limits = seq(30000, 45000, 5000))
f_states[, avg_rate := averagprice/min(averagprice)][, med_rate := medprice/min(medprice)] %>%
ggplot(aes(x = state_only, y = averagprice))+
geom_col_interactive(aes(fill = state_only))+
scale_fill_brewer(palette = "Paired")+
scale_y_continuous(labels = comma, limits = seq(30000, 45000, 5000))
df_states[, avg_rate := averagprice/min(averagprice)][, med_rate := medprice/min(medprice)] %>%
ggplot(aes(x = state_only, y = averagprice))+
geom_col_interactive(aes(fill = state_only))+
scale_fill_brewer(palette = "Paired")+
scale_y_continuous(labels = comma, limits = seq(30000, 45000, 5000))
df_states[, avg_rate := averagprice/min(averagprice)][, med_rate := medprice/min(medprice)] %>%
ggplot(aes(x = state_only, y = averagprice))+
geom_col_interactive(aes(fill = state_only))+
scale_fill_brewer(palette = "Paired")+
scale_y_continuous(labels = comma, limits = seq(0, 45000, 5000))
df_states[, avg_rate := averagprice/min(averagprice)][, med_rate := medprice/min(medprice)] %>%
ggplot(aes(x = state_only, y = averagprice))+
geom_col_interactive(aes(fill = state_only))+
scale_fill_brewer(palette = "Paired")+
scale_y_continuous(labels = comma)
df_states[, avg_rate := averagprice/min(averagprice)][, med_rate := medprice/min(medprice)] %>%
ggplot(aes(x = state_only, y = averagprice))+
geom_col_interactive(aes(fill = state_only))+
scale_fill_brewer(palette = "Paired")+
scale_y_continuous(labels = comma, limits = c(30000,45000))
df_states[, avg_rate := averagprice/min(averagprice)][, med_rate := medprice/min(medprice)] %>%
ggplot(aes(x = state_only, y = averagprice))+
geom_col_interactive(aes(fill = state_only))+
scale_fill_brewer(palette = "Paired")+
coord_cartesian(ylim = c(30000,45000))
df_states[, avg_rate := averagprice/min(averagprice)-1][, med_rate := medprice/min(medprice)]
df_states[, avg_rate := percent(averagprice/min(averagprice)-1)][, med_rate := medprice/min(medprice)]
View(df_states)
df_states[, avg_rate := averagprice/min(averagprice)][, med_rate := medprice/min(medprice)] %>%
ggplot(aes(x = state_only, y = averagprice))+
geom_col_interactive(aes(fill = state_only))+
geom_text(aes(label = avg_rate), vjust = 0.5, hjust = -0.25)+
scale_fill_brewer(palette = "Paired")+
coord_cartesian(ylim = c(30000,45000))
df_states[, avg_rate := percent(averagprice/min(averagprice)-1)][, med_rate := medprice/min(medprice)] %>%
ggplot(aes(x = state_only, y = averagprice))+
geom_col_interactive(aes(fill = state_only))+
geom_text(aes(label = avg_rate), vjust = 0.5, hjust = -0.25)+
scale_fill_brewer(palette = "Paired")+
coord_cartesian(ylim = c(30000,45000))
df_states[, avg_rate := percent(averagprice/min(averagprice)-1)][, med_rate := medprice/min(medprice)] %>%
ggplot(aes(x = state_only, y = averagprice))+
geom_col_interactive(aes(fill = state_only))+
geom_text(aes(label = avg_rate), vjust = 1, hjust = -0.25)+
scale_fill_brewer(palette = "Paired")+
coord_cartesian(ylim = c(30000,45000))
df_states[, avg_rate := percent(averagprice/min(averagprice)-1)][, med_rate := medprice/min(medprice)] %>%
ggplot(aes(x = state_only, y = averagprice))+
geom_col_interactive(aes(fill = state_only))+
geom_text(aes(label = avg_rate), vjust = -0.5, hjust = -0.25)+
scale_fill_brewer(palette = "Paired")+
coord_cartesian(ylim = c(30000,45000))
df_states[, avg_rate := percent(averagprice/min(averagprice)-1)][, med_rate := medprice/min(medprice)] %>%
ggplot(aes(x = state_only, y = averagprice))+
geom_col_interactive(aes(fill = state_only))+
geom_text(aes(label = avg_rate), vjust = -0.5, hjust = 0)+
scale_fill_brewer(palette = "Paired")+
coord_cartesian(ylim = c(30000,45000))
df_states[, avg_rate := percent(averagprice/min(averagprice)-1)][, med_rate := medprice/min(medprice)] %>%
ggplot(aes(x = state_only, y = averagprice))+
geom_col_interactive(aes(fill = state_only))+
geom_text(aes(label = avg_rate), vjust = -0.5, hjust = -0.25)+
scale_fill_brewer(palette = "Paired")+
coord_cartesian(ylim = c(30000,45000))
df_states[, avg_rate := percent(averagprice/min(averagprice)-1)][, med_rate := medprice/min(medprice)] %>%
ggplot(aes(x = state_only, y = averagprice))+
geom_col_interactive(aes(fill = state_only))+
geom_text(aes(label = avg_rate), vjust = -0.5, hjust = 0.5)+
scale_fill_brewer(palette = "Paired")+
coord_cartesian(ylim = c(30000,45000))
df_states[, avg_rate := percent(averagprice/min(averagprice)-1)][, med_rate := medprice/min(medprice)] %>%
ggplot(aes(x = state_only, y = averagprice))+
geom_col_interactive(aes(fill = state_only))+
geom_text(aes(label = avg_rate), vjust = -0.5, hjust = 0.5)+
scale_fill_brewer(palette = "Paired")+
coord_cartesian(ylim = c(30000,45000))+
scale_y_continuous(labels = comma)
df_states[, avg_rate := percent(averagprice/min(averagprice)-1)][, med_rate := medprice/min(medprice)] %>%
ggplot(aes(x = state_only, y = averagprice))+
geom_col_interactive(aes(fill = state_only))+
geom_text(aes(label = avg_rate), vjust = -0.5, hjust = 0.5)+
scale_fill_brewer(palette = "Paired")+
coord_cartesian(ylim = c(30000,45000))+
scale_y_continuous(labels = comma)+
labs( x = "State", y = "Average Price", title = "Average Price in each State & % changes compare to North Territory")
df_states[, avg_rate := percent(averagprice/min(averagprice)-1)][, med_rate := medprice/min(medprice)] %>%
ggplot(aes(x = state_only, y = averagprice))+
geom_col_interactive(aes(fill = state_only))+
geom_text(aes(label = avg_rate), vjust = -0.5, hjust = 0.5)+
scale_fill_brewer(palette = "Paired")+
coord_cartesian(ylim = c(30000,45000))+
scale_y_continuous(labels = comma)+
labs( x = "State", y = "Average Price", title = "Average Price in each State & % changes compare to North Territory", fill = "State")
df_states[, avg_rate := percent(averagprice/min(averagprice)-1)][, med_rate := medprice/min(medprice)] %>%
ggplot(aes(x = state_only, y = averagprice))+
geom_col_interactive(aes(fill = state_only, tooltip = averagprice, data_id = averagprice))+
geom_text(aes(label = avg_rate), vjust = -0.5, hjust = 0.5)+
scale_fill_brewer(palette = "Paired")+
coord_cartesian(ylim = c(30000,45000))+
scale_y_continuous(labels = comma)+
labs( x = "State", y = "Average Price", title = "Average Price in each State & % changes compare to North Territory", fill = "State")
gg_state <- df_states[, avg_rate := percent(averagprice/min(averagprice)-1)][, med_rate := medprice/min(medprice)] %>%
ggplot(aes(x = state_only, y = averagprice))+
geom_col_interactive(aes(fill = state_only, tooltip = averagprice, data_id = averagprice))+
geom_text(aes(label = avg_rate), vjust = -0.5, hjust = 0.5)+
scale_fill_brewer(palette = "Paired")+
coord_cartesian(ylim = c(30000,45000))+
scale_y_continuous(labels = comma)+
labs( x = "State", y = "Average Price", title = "Average Price in each State & % changes compare to North Territory", fill = "State")
ggiraph(ggobj = gg_state)
gg_state <- df_states[, avg_rate := percent(averagprice/min(averagprice)-1)][, med_rate := medprice/min(medprice)] %>%
ggplot(aes(x = state_only, y = averagprice))+
geom_col_interactive(aes(fill = state_only, tooltip = averagprice, data_id = averagprice))+
geom_text(aes(label = avg_rate), vjust = -0.5, hjust = 0.5)+
scale_fill_brewer(palette = "Paired")+
coord_cartesian(ylim = c(30000,43000))+
scale_y_continuous(labels = comma)+
labs( x = "State", y = "Average Price", title = "Average Price in each State & % changes compare to North Territory", fill = "State")
ggiraph(ggobj = gg_state)
gg_state <- df_states[, avg_rate := percent(averagprice/min(averagprice)-1)][, med_rate := medprice/min(medprice)] %>%
ggplot(aes(x = state_only, y = averagprice))+
geom_col_interactive(aes(fill = state_only, tooltip = averagprice, data_id = averagprice))+
geom_text(aes(label = avg_rate), vjust = -0.5, hjust = 0.5)+
scale_fill_brewer(palette = "Paired")+
coord_cartesian(ylim = c(30000,43000))+
scale_y_continuous(labels = comma)+
labs( x = "State", y = "Average Price", title = "Average Price among States & % changes compare to North Territory", fill = "State")
ggiraph(ggobj = gg_state)
gg_state <- df_states[, avg_rate := percent(averagprice/min(averagprice)-1)][, med_rate := medprice/min(medprice)] %>%
ggplot(aes(x = state_only, y = averagprice))+
geom_col_interactive(aes(fill = state_only, tooltip = averagprice, data_id = averagprice))+
geom_text(aes(label = avg_rate), vjust = -0.5, hjust = 0.5)+
scale_fill_brewer(palette = "Paired")+
coord_cartesian(ylim = c(30000,43000))+
scale_y_continuous(labels = comma)+
labs( x = "State", y = "Average Price", title = "Average Price among States & % changes compare to NT", fill = "State")
ggiraph(ggobj = gg_state)
gg_state <- df_states[, avg_rate := percent(averagprice/min(averagprice)-1)][, med_rate := medprice/min(medprice)] %>%
ggplot(aes(x = state_only, y = averagprice))+
geom_col_interactive(aes(fill = state_only, tooltip = averagprice, data_id = averagprice))+
geom_text(aes(label = avg_rate), vjust = -0.5, hjust = 0.5)+
scale_fill_brewer(palette = "Paired")+
coord_cartesian(ylim = c(30000,43000))+
scale_y_continuous(labels = comma)+
labs( x = "State", y = "Average Price", title = "Average Price in States & % changes compare to NT", fill = "State")
ggiraph(ggobj = gg_state)
