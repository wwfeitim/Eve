scale_y_continuous(labels = comma, breaks = seq(0,300000,25000))+
labs(x ="Makes", y = "Mean Price", fill = "Makes", title = "Mean Price by Makes")+
geom_line(aes(x = make, y = 50000, group = 1))+
geom_line(aes(x = make, y = 100000, group = 1))
ggiraph(ggobj = gg_make_meanprice)
gg_make_medprice <- tab_make_medprice %>%
ggplot(aes(x = reorder(make, med_price), y = med_price, fill = make))+
geom_col_interactive(aes(tooltip = med_price, data_id=med_price))+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5))+
scale_y_continuous(labels = comma, breaks = seq(0,300000,25000))+
labs(x ="Makes", y = "Median Price", fill = "Makes", title = "Median Price by Makes")+
geom_line(aes(x = make, y = 50000, group = 1))+
geom_line(aes(x = make, y = 100000, group = 1))
ggiraph(ggobj = gg_make_medprice)
tab_make_meanprice %>%
ggplot(aes(x = reorder(make, price), y = price))+
geom_boxplot()
df_ev %>%
ggplot(aes(x = reorder(make, price), y = price))+
geom_boxplot()
df_ev %>%
ggplot(aes(x = reorder(make, price), y = price))+
geom_boxplot()
df_ev %>%
ggplot(aes(x = reorder(make, price), y = price, fill = make))+
geom_boxplot()
df_ev %>%
ggplot(aes(x = reorder(make, price), y = price, fill = make))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
df_ev %>%
ggplot(aes(x = reorder(make, price), y = price, fill = make))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5))+
scale_y_continuous(labels = comma, breaks = seq(0,300000,25000))+
geom_line(aes(x = make, y = 50000, group = 1))+
geom_line(aes(x = make, y = 100000, group = 1))
df_ev %>%
ggplot(aes(x = reorder(make, price), y = price, fill = make))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5))+
scale_y_continuous(labels = comma, breaks = seq(0,300000,25000))+
geom_line(aes(x = make, y = 50000, group = 1))+
geom_line(aes(x = make, y = 100000, group = 1))+
labs(x ="Makes", y = "Price", fill = "Makes", title = "Price by Makes")
df_ev %>%
ggplot(aes(x = reorder(make, price), y = price, fill = make))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5))+
scale_y_continuous(labels = comma, breaks = seq(0,400000,25000))+
geom_line(aes(x = make, y = 50000, group = 1))+
geom_line(aes(x = make, y = 100000, group = 1))+
labs(x ="Makes", y = "Price", fill = "Makes", title = "Price by Makes")
df_ev %>%
ggplot(aes(x = reorder(make, price), y = price, fill = make))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5))+
scale_y_continuous(labels = comma, breaks = seq(0,400000,25000))+
geom_line(aes(x = make, y = 50000, group = 1))+
geom_line(aes(x = make, y = 100000, group = 1))+
geom_line(aes(x = make, y = 150000, group = 1))+
labs(x ="Makes", y = "Price", fill = "Makes", title = "Price by Makes")
gg_box_make_price <- df_ev %>%
ggplot(aes(x = reorder(make, price), y = price, fill = make))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5))+
scale_y_continuous(labels = comma, breaks = seq(0,400000,25000))+
geom_line(aes(x = make, y = 50000, group = 1))+
geom_line(aes(x = make, y = 100000, group = 1))+
geom_line(aes(x = make, y = 150000, group = 1))+
labs(x ="Makes", y = "Price", fill = "Makes", title = "Price by Makes")
ggiraph(ggobj = gg_make_meanprice)
ggiraph(ggobj = gg_make_medprice)
df_ev[!make == "Renault"]
df_ev[make == "Renault"]
df_ev[, .N, body_type]
gg_box_make_price
df_ev[, .N, .(make, kw)]
df_ev[,.N,kw]
unique(df_ev$kw)
df_ev[!is.na(kw)] %>%
ggplot(aes(x=make, y=kw))
df_ev[!is.na(kw)] %>%
ggplot(aes(x=make, y=kw))+
geom_point()
df_ev[!is.na(kw)] %>%
ggplot(aes(x=make, y=kw, fill = make))+
geom_point()
df_ev[!is.na(kw)] %>%
ggplot(aes(x=make, y=kw, color = make))+
geom_point()
df_ev[!is.na(kw)] %>%
ggplot(aes(x=make, y=kw, color = make))+
geom_point()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
df_ev[!is.na(kw)] %>%
ggplot(aes(x=make, y=kw, color = make))+
geom_point()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5))+
geom_line(aes(x=make, y=100))
df_ev[!is.na(kw)] %>%
ggplot(aes(x=make, y=kw, color = make))+
geom_point()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5))+
geom_line(aes(x=make, y=100, group =1))
df_ev[!is.na(kw)] %>%
ggplot(aes(x=make, y=kw, color = make))+
geom_point()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5))+
geom_line(aes(x=make, y=c(100,200,300), group =1))+
```
df_ev[!is.na(kw)] %>%
ggplot(aes(x=make, y=kw, color = make))+
geom_point()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5))+
geom_line(aes(x=make, y=c(100,200,300), group =1))
df_ev[!is.na(kw)] %>%
ggplot(aes(x=make, y=kw, color = make))+
geom_point()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5))+
geom_line(aes(x=make, y=100, group =1))+
```
df_ev[!is.na(kw)] %>%
ggplot(aes(x=make, y=kw, color = make))+
geom_point()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5))+
geom_line(aes(x=make, y=100, group =1))+
geom_line(aes(x=make, y=200, group =1))+
geom_line(aes(x=make, y=300, group =1))+
```
df_ev[!is.na(kw)] %>%
ggplot(aes(x=make, y=kw, color = make))+
geom_point()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5))+
geom_line(aes(x=make, y=100, group =1))+
geom_line(aes(x=make, y=200, group =1))+
geom_line(aes(x=make, y=300, group =1))
df_ev[!is.na(kw)] %>%
ggplot(aes(x=make, y=kw, color = make))+
geom_point()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5))+
geom_line(aes(x=make, y=100, group =1))+
geom_line(aes(x=make, y=200, group =1))+
geom_line(aes(x=make, y=300, group =1))+
labs(x="Makes",y="Battery KW", color = "Makes", title = "Battery Power (KW) by Makes")
gg_point_kw <- df_ev[!is.na(kw)] %>%
ggplot(aes(x=make, y=kw, color = make))+
geom_point()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5))+
geom_line(aes(x=make, y=100, group =1))+
geom_line(aes(x=make, y=200, group =1))+
geom_line(aes(x=make, y=300, group =1))+
labs(x="Makes",y="Battery KW", color = "Makes", title = "Battery Power (KW) by Makes")
df_ev[!is.na(kw) & !is.na(range_km)]
df_ev[!is.na(kw) & !is.na(range_km)] %>%
ggplot(aes(x=range_km, y=kw, color = make))+
geom_point()+
theme(axis.text.x = element_text(angle = 0, vjust = 0.5))+
geom_line(aes(x=range_km, y=100, group =1))+
geom_line(aes(x=range_km, y=200, group =1))+
geom_line(aes(x=range_km, y=300, group =1))+
labs(x="Makes",y="Battery KW", color = "Makes", title = "Battery Power (KW) by Makes")
df_ev[!is.na(kw) & !is.na(range_km)] %>%
ggplot(aes(x=range_km, y=kw, color = make))+
geom_point()+
theme(axis.text.x = element_text(angle = 0, vjust = 0.5))+
geom_line(aes(x=range_km, y=100, group =1))+
geom_line(aes(x=range_km, y=200, group =1))+
geom_line(aes(x=range_km, y=300, group =1))+
labs(x="Makes",y="Battery KW", color = "Travel Range", title = "Battery Power (KW) by Makes")
df_ev[!is.na(kw) & !is.na(range_km)] %>%
ggplot(aes(x=range_km, y=kw, color = make))+
geom_point()+
theme(axis.text.x = element_text(angle = 0, vjust = 0.5))+
geom_line(aes(x=range_km, y=100, group =1))+
geom_line(aes(x=range_km, y=200, group =1))+
geom_line(aes(x=range_km, y=300, group =1))+
labs(x="Travel Range",y="Battery KW", color = "Makes", title = "Battery Power (KW) by Makes")
df_ev[!is.na(kw) & !is.na(range_km)] %>%
ggplot(aes(x=range_km, y=kw, color = make))+
geom_point()+
theme(axis.text.x = element_text(angle = 0, vjust = 0.5))+
geom_line(aes(x=range_km, y=100, group =1))+
geom_line(aes(x=range_km, y=200, group =1))+
geom_line(aes(x=range_km, y=300, group =1))+
labs(x="Travel Range (KM)",y="Battery KW", color = "Makes", title = "Battery Power (KW) by Makes")
df_ev[!is.na(kw) & !is.na(range_km)] %>%
ggplot(aes(x=range_km, y=kw, color = make))+
geom_point()+
theme(axis.text.x = element_text(angle = 0, vjust = 0.5))+
geom_line(aes(x=range_km, y=100, group =1))+
geom_line(aes(x=range_km, y=200, group =1))+
geom_line(aes(x=range_km, y=300, group =1))+
labs(x="Travel Range (KM)",y="Battery (KW)", color = "Makes", title = "Battery Power (KW) by Makes")
library(ggpubr)
gg_point_KW_KM <- df_ev[!is.na(kw) & !is.na(range_km)] %>%
ggplot(aes(x=range_km, y=kw, color = make))+
geom_point()+
theme(axis.text.x = element_text(angle = 0, vjust = 0.5))+
geom_line(aes(x=range_km, y=100, group =1))+
geom_line(aes(x=range_km, y=200, group =1))+
geom_line(aes(x=range_km, y=300, group =1))+
labs(x="Travel Range (KM)",y="Battery (KW)", color = "Makes", title = "Battery Power (KW) by Makes")
ggarrange(gg_point_kw, gg_point_KW_KM,
ncol = 2)
ggarrange(gg_point_kw, gg_point_KW_KM,
ncol = 1)
df_ev[!is.na(price) & !is.na(range_km)]
df_ev[!is.na(price) & !is.na(range_km)] %>%
ggplot(aes(x=price, y=range_km, color = make))+
geom_point()+
theme(axis.text.x = element_text(angle = 0, vjust = 0.5))+
geom_line(aes(x=50000, y=range_km, group =1))+
geom_line(aes(x=100000, y=range_km, group =1))+
geom_line(aes(x=150000, y=range_km, group =1))+
labs(x="Travel Range (KM)",y="Battery (KW)", color = "Makes", title = "Battery Power (KW) by Makes")
df_ev[!is.na(price) & !is.na(range_km)] %>%
ggplot(aes(x=price, y=range_km, color = make))+
geom_point()+
theme(axis.text.x = element_text(angle = 0, vjust = 0.5))+
geom_line(aes(x=50000, y=range_km, group =1))+
geom_line(aes(x=100000, y=range_km, group =1))+
geom_line(aes(x=150000, y=range_km, group =1))+
labs(x="price",y="range_km", color = "Makes", title = "Battery Power (KW) by Makes")
df_ev[!is.na(price) & !is.na(range_km)] %>%
ggplot(aes(x=price, y=range_km, color = make))+
geom_point()+
geom_smooth()
df_ev[!is.na(price) & !is.na(range_km)] %>%
ggplot(aes(x=price, y=range_km, color = make))+
geom_point()+
geom_smooth()+
theme(axis.text.x = element_text(angle = 0, vjust = 0.5))+
geom_line(aes(x=50000, y=range_km, group =1))+
geom_line(aes(x=100000, y=range_km, group =1))+
geom_line(aes(x=150000, y=range_km, group =1))+
labs(x="price",y="range_km", color = "Makes", title = "Battery Power (KW) by Makes")
df_ev[!is.na(price) & !is.na(range_km)] %>%
ggplot(aes(x=price, y=range_km, color = make))+
geom_point()+
theme(axis.text.x = element_text(angle = 0, vjust = 0.5))+
geom_line(aes(x=50000, y=range_km, group =1))+
geom_line(aes(x=100000, y=range_km, group =1))+
geom_line(aes(x=150000, y=range_km, group =1))+
labs(x="price",y="range_km", color = "Makes", title = "Battery Power (KW) by Makes")
df_ev[!is.na(price) & !is.na(range_km)] %>%
ggplot(aes(x=range_km, y=price, color = make))+
geom_point()+
theme(axis.text.x = element_text(angle = 0, vjust = 0.5))+
geom_line(aes(y=50000, x=range_km, group =1))+
geom_line(aes(y=100000, x=range_km, group =1))+
geom_line(aes(y=150000, x=range_km, group =1))+
labs(x="price",y="range_km", color = "Makes", title = "Battery Power (KW) by Makes")
df_ev[!is.na(price) & !is.na(range_km)] %>%
ggplot(aes(x=range_km, y=price, color = make))+
geom_point()+
theme(axis.text.x = element_text(angle = 0, vjust = 0.5))+
geom_line(aes(y=50000, x=range_km, group =1))+
geom_line(aes(y=100000, x=range_km, group =1))+
geom_line(aes(y=150000, x=range_km, group =1))+
labs(x="Travel Range (KM)",y="Price", color = "Makes", title = "Battery Power (KW) by Makes")
gg_point_KW_KM <- df_ev[!is.na(kw) & !is.na(range_km)] %>%
ggplot(aes(x=range_km, y=kw, color = make))+
geom_point()+
theme(axis.text.x = element_text(angle = 0, vjust = 0.5))+
geom_line(aes(x=range_km, y=100, group =1))+
geom_line(aes(x=range_km, y=200, group =1))+
geom_line(aes(x=range_km, y=300, group =1))+
labs(x="Travel Range (KM)",y="Battery (KW)", color = "Makes", title = "Battery Power(KW) & Travel Range by Makes")
df_ev[!is.na(price) & !is.na(range_km)] %>%
ggplot(aes(x=range_km, y=price, color = make))+
geom_point()+
theme(axis.text.x = element_text(angle = 0, vjust = 0.5))+
geom_line(aes(y=50000, x=range_km, group =1))+
geom_line(aes(y=100000, x=range_km, group =1))+
geom_line(aes(y=150000, x=range_km, group =1))+
labs(x="Travel Range (KM)",y="Price", color = "Makes", title = "Battery Power (KW) by Makes")+
scale_y_continuous(labels = comma)
df_ev[!is.na(price) & !is.na(range_km)] %>%
ggplot(aes(x=range_km, y=price, color = make))+
geom_point()+
theme(axis.text.x = element_text(angle = 0, vjust = 0.5))+
geom_line(aes(y=50000, x=range_km, group =1))+
geom_line(aes(y=100000, x=range_km, group =1))+
geom_line(aes(y=150000, x=range_km, group =1))+
geom_line(aes(x=400, y =price))+
labs(x="Travel Range (KM)",y="Price (AUD)", color = "Makes", title = "Battery Power (KW) by Makes")+
scale_y_continuous(labels = comma)
df_ev[!is.na(price) & !is.na(range_km)] %>%
ggplot(aes(x=range_km, y=price, color = make))+
geom_point()+
theme(axis.text.x = element_text(angle = 0, vjust = 0.5))+
geom_line(aes(y=50000, x=range_km, group =1))+
geom_line(aes(y=100000, x=range_km, group =1))+
geom_line(aes(y=150000, x=range_km, group =1))+
geom_line(aes(x=400, y =price))+
labs(x="Travel Range (KM)",y="Price (AUD)", color = "Makes", title = "Battery Power (KW) by Makes")+
scale_y_continuous(labels = comma, breaks = seq(0, 400000, 50000))
gg_point_range_price <- df_ev[!is.na(price) & !is.na(range_km)] %>%
ggplot(aes(x=range_km, y=price, color = make))+
geom_point()+
theme(axis.text.x = element_text(angle = 0, vjust = 0.5))+
geom_line(aes(y=50000, x=range_km, group =1))+
geom_line(aes(y=100000, x=range_km, group =1))+
geom_line(aes(y=150000, x=range_km, group =1))+
geom_line(aes(x=400, y =price))+
labs(x="Travel Range (KM)",y="Price (AUD)", color = "Makes", title = "Battery Power (KW) by Makes")+
scale_y_continuous(labels = comma, breaks = seq(0, 400000, 50000))
ggarrange(gg_point_kw, gg_point_KW_KM,gg_point_range_price,
ncol = 1)
gg_point_kw
gg_point_KW_KM
## add
model1 <- df_ev %>% lm(range_km ~ kw)
## add
model1 <- df_ev %>% lm(range_km ~ kw)
## add
model1 <- df_ev %>% lm(range_km ~ kw, data = .)
model1
summary(model1)
gg_point_range_price
###
gg_point_range_price <- df_ev[!is.na(price) & !is.na(range_km)] %>%
ggplot(aes(x=range_km, y=price, color = make))+
geom_point()+
theme(axis.text.x = element_text(angle = 0, vjust = 0.5))+
geom_line(aes(y=50000, x=range_km, group =1))+
geom_line(aes(y=100000, x=range_km, group =1))+
geom_line(aes(y=150000, x=range_km, group =1))+
geom_line(aes(x=400, y =price))+
labs(x="Travel Range (KM)",y="Price (AUD)", color = "Makes", title = "Battery (KW)&Price by Makes")+
scale_y_continuous(labels = comma, breaks = seq(0, 400000, 50000))
gg_point_range_price
###
gg_point_range_price <- df_ev[!is.na(price) & !is.na(range_km)] %>%
ggplot(aes(x=range_km, y=price, color = make))+
geom_point()+
theme(axis.text.x = element_text(angle = 0, vjust = 0.5))+
geom_line(aes(y=50000, x=range_km, group =1))+
geom_line(aes(y=100000, x=range_km, group =1))+
geom_line(aes(y=150000, x=range_km, group =1))+
geom_line(aes(x=400, y =price))+
labs(x="Travel Range (KM)",y="Price (AUD)", color = "Makes", title = "Battery (KW) & Price by Makes")+
scale_y_continuous(labels = comma, breaks = seq(0, 400000, 50000))
gg_point_range_price
##
model2 <- df_ev %>% lm(price ~ range_km, data = .)
summary(model2)
##
model2 <- df_ev %>% lm(price ~ make + range_km, data = .)
summary(model2)
##
model2 <- df_ev %>% lm(price ~ make + range_km + my + odo, data = .)
summary(model2)
summary(model2)
###
gg_point_range_price <- df_ev[!is.na(price) & !is.na(range_km)] %>%
ggplot(aes(x=range_km, y=price, color = make))+
geom_point_interactive(aes(tooltip = make, data_id=make))+
theme(axis.text.x = element_text(angle = 0, vjust = 0.5))+
geom_line(aes(y=50000, x=range_km, group =1))+
geom_line(aes(y=100000, x=range_km, group =1))+
geom_line(aes(y=150000, x=range_km, group =1))+
geom_line(aes(x=400, y =price))+
labs(x="Travel Range (KM)",y="Price (AUD)", color = "Makes", title = "Battery (KW) & Price by Makes")+
scale_y_continuous(labels = comma, breaks = seq(0, 400000, 50000))
ggiraph(ggobj = gg_point_range_price)
summary(model2)
df_ev[make == "Jaguar"]
df_ev[make == "Jaguar"]
df_ev[,.N,make]
df_ev[make == "Jaguar"]
?str_detect
df_ev[, range_km := ifelse(str_detect(make, "Jaguar"), 446, range_km)]
df_ev[make == "Jaguar"]
# Makes
## Price
tab_make_meanprice <- df_ev[!is.na(price), .(mean_price = round(mean(price), 2)), make][
order(mean_price)
]
tab_make_medprice <- df_ev[!is.na(price), .(med_price = round(median(price), 2)), make][
order(med_price)
]
# use reorder to sort
gg_make_meanprice <- tab_make_meanprice %>%
ggplot(aes(x = reorder(make, mean_price), y = mean_price, fill = make))+
geom_col_interactive(aes(tooltip = mean_price, data_id=mean_price))+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5))+
scale_y_continuous(labels = comma, breaks = seq(0,300000,25000))+
labs(x ="Makes", y = "Mean Price", fill = "Makes", title = "Mean Price by Makes")+
geom_line(aes(x = make, y = 50000, group = 1))+
geom_line(aes(x = make, y = 100000, group = 1))
gg_make_medprice <- tab_make_medprice %>%
ggplot(aes(x = reorder(make, med_price), y = med_price, fill = make))+
geom_col_interactive(aes(tooltip = med_price, data_id=med_price))+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5))+
scale_y_continuous(labels = comma, breaks = seq(0,300000,25000))+
labs(x ="Makes", y = "Median Price", fill = "Makes", title = "Median Price by Makes")+
geom_line(aes(x = make, y = 50000, group = 1))+
geom_line(aes(x = make, y = 100000, group = 1))
ggiraph(ggobj = gg_make_meanprice)
ggiraph(ggobj = gg_make_medprice)
gg_box_make_price <- df_ev %>%
ggplot(aes(x = reorder(make, price), y = price, fill = make))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5))+
scale_y_continuous(labels = comma, breaks = seq(0,400000,25000))+
geom_line(aes(x = make, y = 50000, group = 1))+
geom_line(aes(x = make, y = 100000, group = 1))+
geom_line(aes(x = make, y = 150000, group = 1))+
labs(x ="Makes", y = "Price", fill = "Makes", title = "Price by Makes")
gg_box_make_price
df_ev[, .N, .(make, kw)]
unique(df_ev$kw)
gg_point_kw <- df_ev[!is.na(kw)] %>%
ggplot(aes(x=make, y=kw, color = make))+
geom_point()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5))+
geom_line(aes(x=make, y=100, group =1))+
geom_line(aes(x=make, y=200, group =1))+
geom_line(aes(x=make, y=300, group =1))+
labs(x="Makes",y="Battery KW", color = "Makes", title = "Battery Power (KW) by Makes")
gg_point_KW_KM <- df_ev[!is.na(kw) & !is.na(range_km)] %>%
ggplot(aes(x=range_km, y=kw, color = make))+
geom_point()+
theme(axis.text.x = element_text(angle = 0, vjust = 0.5))+
geom_line(aes(x=range_km, y=100, group =1))+
geom_line(aes(x=range_km, y=200, group =1))+
geom_line(aes(x=range_km, y=300, group =1))+
labs(x="Travel Range (KM)",y="Battery (KW)", color = "Makes", title = "Battery Power(KW) & Travel Range by Makes")
## add
model1 <- df_ev %>% lm(range_km ~ kw, data = .)
summary(model1)
###
gg_point_range_price <- df_ev[!is.na(price) & !is.na(range_km)] %>%
ggplot(aes(x=range_km, y=price, color = make))+
geom_point_interactive(aes(tooltip = make, data_id=make))+
theme(axis.text.x = element_text(angle = 0, vjust = 0.5))+
geom_line(aes(y=50000, x=range_km, group =1))+
geom_line(aes(y=100000, x=range_km, group =1))+
geom_line(aes(y=150000, x=range_km, group =1))+
geom_line(aes(x=400, y =price))+
labs(x="Travel Range (KM)",y="Price (AUD)", color = "Makes", title = "Battery (KW) & Price by Makes")+
scale_y_continuous(labels = comma, breaks = seq(0, 400000, 50000))
##
model2 <- df_ev %>% lm(price ~ make + range_km + my + odo, data = .)
summary(model2)
df_ev[make == "Jaguar"]
## add
model1 <- df_ev %>% lm(range_km ~ kw, data = .)
summary(model1)
gg_point_kw
gg_point_KW_KM
ggiraph(ggobj = gg_point_range_price)
summary(model2)
##
model2 <- df_ev %>% lm(price ~ make + range_km + as.factor(my) + odo, data = .)
summary(model2)
df_ev[, my := as.factor(my)]
##
model2 <- df_ev %>% lm(price ~ make + range_km + my + odo, data = .)
summary(model2)
df_ev[, .(mean_price = mean(price)), .(make, body_type)]
df_ev[!is.na(price), .(mean_price = mean(price)), .(make, body_type)]
df_ev[!is.na(price)&!is.na(body_type), .(mean_price = mean(price)), .(make, body_type)]
df_ev[!is.na(price)& !is.na(body_type), .(mean_price = mean(price)), .(make, body_type)]
df_ev[body_type == ""]
df_ev[!is.na(price)& !body_type == "", .(mean_price = mean(price)), .(make, body_type)]
df_ev[!is.na(price)& !body_type == "", .(mean_price = mean(price)), .(make, body_type)] %>%
ggplot(aes(x=make, y=mean_price, fill = body_type))+
geom_col_interactive()
df_ev[!is.na(price)& !body_type == "", .(mean_price = mean(price)), .(make, body_type)] %>%
ggplot(aes(x=make, y=mean_price, fill = body_type))+
geom_col_interactive(aes(tooltip = mean_price, data_id = mean_price))+
theme(axis.text.x = element_text(angle = 0, vjust = 0.5))
df_ev[!is.na(price)& !body_type == "", .(mean_price = mean(price)), .(make, body_type)] %>%
ggplot(aes(x=make, y=mean_price, fill = body_type))+
geom_col_interactive(aes(tooltip = mean_price, data_id = mean_price))+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
df_ev[!is.na(price)& !body_type == "", .(mean_price = mean(price)), .(make, body_type)] %>%
ggplot(aes(x=make, y=mean_price, fill = body_type))+
geom_col_interactive(aes(tooltip = mean_price, data_id = mean_price))+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5))+
scale_y_continuous(labels = comma)
df_ev[!is.na(price)& !body_type == "", .(mean_price = mean(price)), .(make, body_type)] %>%
ggplot(aes(x=make, y=mean_price, fill = body_type))+
geom_col_interactive(aes(tooltip = mean_price, data_id = mean_price))+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5))+
scale_y_continuous(labels = comma, breaks = seq(0, 600000, 100000))
df_ev[!is.na(price)& !body_type == "", .(mean_price = mean(price)), .(make, body_type)] %>%
ggplot(aes(x=make, y=mean_price, fill = body_type))+
geom_col_interactive(aes(tooltip = mean_price, data_id = mean_price))+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5))+
scale_y_continuous(labels = comma, breaks = seq(0, 600000, 100000))+
labs(x="Makes",y="Mean Price (AUD)", fill = "Body Types", title = "Stacked Mean Prices by body types and makes")
gg_col_price_body_make <- df_ev[!is.na(price)& !body_type == "", .(mean_price = mean(price)), .(make, body_type)] %>%
ggplot(aes(x=make, y=mean_price, fill = body_type))+
geom_col_interactive(aes(tooltip = mean_price, data_id = mean_price))+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5))+
scale_y_continuous(labels = comma, breaks = seq(0, 600000, 100000))+
labs(x="Makes",y="Mean Price (AUD)", fill = "Body Types", title = "Stacked Mean Prices by Body Types and Makes")
ggiraph(ggobj = gg_col_price_body_make)
df_ev[!is.na(price)& !body_type == "", .(mean_price = round(mean(price)), 2), .(make, body_type)]
df_ev[!is.na(price)& !body_type == "", .(mean_price = round(mean(price),2)), .(make, body_type)]
gg_col_price_body_make <- df_ev[!is.na(price)& !body_type == "", .(mean_price = round(mean(price),2)), .(make, body_type)] %>%
ggplot(aes(x=make, y=mean_price, fill = body_type))+
geom_col_interactive(aes(tooltip = mean_price, data_id = mean_price))+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5))+
scale_y_continuous(labels = comma, breaks = seq(0, 600000, 100000))+
labs(x="Makes",y="Mean Price (AUD)", fill = "Body Types", title = "Stacked Mean Prices by Body Types and Makes")
ggiraph(ggobj = gg_col_price_body_make)
df_ev[make == "Renault"]
